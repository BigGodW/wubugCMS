import{E as i,s as U,t as R,H as I,K as h,f as q,r as B}from"./element-plus.js";import{u as C,a as M}from"./vue-router.js";import{d as j,h as F,u as T}from"./model.js";import{_ as D}from"./index.js";import{r as f,I as _,j as G,o as H,c as K,M as r,Q as a,U as u}from"./@vue.js";import"./lodash-es.js";import"./async-validator.js";import"./dayjs.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./codemirror-wrapped-line-indent.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css        */const O={class:"bg-fff pd-20 radius-6"},Q={__name:"edit",setup(S){const b=C(),g=M(),n=f(null),o=_({id:0,old_tableName:"",model:"",tableName:"",remark:"",status:1}),p=f(!1),d=_({model:[{required:!0,message:"请输入模型名称",trigger:"blur"}],tableName:[{required:!0,message:"请输入表名",trigger:"blur"},{validator:V,trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]});function V(t,e,s){e.startsWith("ext_")?s():s(new Error("表名必须以 ext_ 开头"))}const v=async()=>{try{const t=await j(o.id);if(t.code===200){const e=t.data;e.status=+e.status,Object.assign(o,{...e,old_tableName:e.tableName})}else i.error(t.msg)}catch(t){console.error(t)}},N=async t=>{try{const e=await F(t);e.code===200?p.value=e.data.count>0:i.error(e.msg)}catch(e){console.error(e)}},k=async()=>{try{const t=await T(o);t.code===200?(i.success("更新成功^_^"),b.go(-1)):i.error(t.msg)}catch(t){console.error(t)}},y=()=>{n.value.validate(t=>{if(t)k();else return console.log("error submit!!"),!1})};return G(async()=>{const t=g.params.id;o.id=t,await v(),await N(t)}),(t,e)=>{const s=U,m=R,c=I,E=h,x=q,w=B;return H(),K("div",O,[r(w,{ref_key:"formRef",ref:n,model:o,"label-width":"100px",class:"mt-20"},{default:a(()=>[r(m,{label:"模型名称",prop:"model",rules:d.model},{default:a(()=>[r(s,{modelValue:o.model,"onUpdate:modelValue":e[0]||(e[0]=l=>o.model=l),placeholder:"请输入模型名称"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,{label:"新增表名",prop:"tableName",rules:d.tableName},{default:a(()=>[r(s,{modelValue:o.tableName,"onUpdate:modelValue":e[1]||(e[1]=l=>o.tableName=l),placeholder:"表名称必须ext_开头"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,{label:"是否启用"},{default:a(()=>[r(E,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=l=>o.status=l)},{default:a(()=>[r(c,{value:1},{default:a(()=>e[4]||(e[4]=[u("开启")])),_:1}),r(c,{disabled:p.value,value:0},{default:a(()=>e[5]||(e[5]=[u("禁用")])),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),r(m,{label:"备注",prop:"remark",rules:d.remark},{default:a(()=>[r(s,{modelValue:o.remark,"onUpdate:modelValue":e[3]||(e[3]=l=>o.remark=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,null,{default:a(()=>[r(x,{type:"primary",onClick:y},{default:a(()=>e[6]||(e[6]=[u("保存")])),_:1})]),_:1})]),_:1},8,["model"])])}}},Re=D(Q,[["__scopeId","data-v-2304e346"]]);export{Re as default};
