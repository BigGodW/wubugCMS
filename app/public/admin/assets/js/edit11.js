import{E as m,s as h,t as x,a as C,D as I,F as M,G as R,f as B,r as D}from"./element-plus.js";import{a as F,u as N}from"./vue-router.js";import{d as j,u as q}from"./slide.js";import{a as O}from"./upload.js";import{r as z,I as G,j as P,ad as Q,o as d,c as S,M as o,Q as l,R as T,W,U as $}from"./@vue.js";import"./lodash-es.js";import"./async-validator.js";import"./dayjs.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./index.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./codemirror-wrapped-line-indent.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css        */import"./sys_config.js";const A={class:"bg-fff pd-20 radius-6"},Fe={__name:"edit",setup(H){const f=F(),_=N(),p=z(null),t=G({id:0,title:"",imgUrl:"",linkUrl:""});P(async()=>{t.id=parseInt(f.params.id,10),await g()});async function g(){try{let e=await j(t.id);const{id:r,title:a,imgUrl:s,linkUrl:n}=e.data;e.code===200?Object.assign(t,{id:r,title:a,imgUrl:s,linkUrl:n}):m({message:e.msg,type:"error"})}catch(e){console.error(e)}}function y(e){return e.type.indexOf("image")===-1?(m("上传文件只能是图片格式"),!1):e.size/1024>200?(m("上传图片必须小于200k"),!1):!0}async function U(e){const r=new FormData;r.append("file",e.file);try{let a=await O(r);a.code===200&&(t.imgUrl=a.data.path)}catch(a){console.error(a)}}async function b(){try{let e=await q(t);e.code==200?(m({message:"更新成功^_^",type:"success"}),_.go(-1)):m({message:e.msg,type:"error"})}catch(e){console.log(e)}}function k(){p.value.validate(e=>{if(e)b();else return console.log("error submit!!"),!1})}return(e,r)=>{const a=h,s=x,n=Q("MostlyCloudy"),v=C,u=I,V=M,c=R,E=B,w=D;return d(),S("div",A,[o(w,{ref_key:"formRef",ref:p,model:t,"label-width":"84px",class:"mt-20"},{default:l(()=>[o(s,{label:"轮播标题",rules:[{required:!0,message:"请输入标题",trigger:"blur"}],prop:"title"},{default:l(()=>[o(a,{modelValue:t.title,"onUpdate:modelValue":r[0]||(r[0]=i=>t.title=i)},null,8,["modelValue"])]),_:1}),o(s,{class:"flex",label:"轮播图"},{default:l(()=>[o(V,{class:"avatar-uploader","http-request":U,"show-file-list":!1,"before-upload":y},{default:l(()=>[o(u,{placement:"top-start",title:"上传",width:200,trigger:"hover",content:"上传图片作为封面图，大小200k内"},{reference:l(()=>[o(v,{class:"avatar-uploader-icon"},{default:l(()=>[o(n)]),_:1})]),_:1})]),_:1}),t.imgUrl?(d(),T(u,{key:0,placement:"right",width:600,trigger:"hover"},{reference:l(()=>[o(c,{class:"avatar-uploader-icon pointer ml-10",src:t.imgUrl},null,8,["src"])]),default:l(()=>[o(c,{style:{width:"100%"},src:t.imgUrl},null,8,["src"])]),_:1})):W("",!0),o(a,{class:"ml-10 flex-1",modelValue:t.imgUrl,"onUpdate:modelValue":r[1]||(r[1]=i=>t.imgUrl=i)},null,8,["modelValue"])]),_:1}),o(s,{label:"轮播链接"},{default:l(()=>[o(a,{modelValue:t.linkUrl,"onUpdate:modelValue":r[2]||(r[2]=i=>t.linkUrl=i)},null,8,["modelValue"])]),_:1}),o(s,null,{default:l(()=>[o(E,{type:"primary",onClick:k},{default:l(()=>r[3]||(r[3]=[$("保存")])),_:1})]),_:1})]),_:1},8,["model"])])}}};export{Fe as default};
