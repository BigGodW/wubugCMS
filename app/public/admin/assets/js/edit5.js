import{s as N,t as j,H as F,R as D,f as L,r as S,L as q,E as y}from"./element-plus.js";import{u as G,a as H}from"./vue-router.js";import{d as O,u as Q}from"./frag.js";import{t as T,_ as W}from"./tinymce.js";import{u as $}from"./upload.js";import{_ as z}from"./index.js";import{r as g,I as p,j as V,o as n,c as A,_ as J,R as u,Q as r,a as K,M as a,U as d,W as b}from"./@vue.js";import"./lodash-es.js";import"./async-validator.js";import"./dayjs.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./sys_config.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./codemirror-wrapped-line-indent.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css        */const P={class:"bg-fff pd-20 radius-6"},X={__name:"edit",setup(Y){const v=G(),k=H(),c=g(null),f=p(T),m=g(!0),e=p({id:0,type:1,name:"",mark:"",content:"欢迎使用ChanCMS系统"}),x=p({name:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:50,message:"名称长度在 2 到 50 个字符之间",trigger:"blur"}]}),E=()=>{m.value=!1},R=async()=>{try{const o=await O(e.id);o.code===200&&(Object.assign(e,o.data),e.type===2&&(m.value=!1))}catch(o){console.error(o)}},w=async()=>{try{const o=await Q(e);o.code===200?(y({message:"更新成功^_^",type:"success"}),v.go(-1)):y({message:o.msg,type:"error"})}catch(o){console.log(o)}},U=()=>{c.value.validate(o=>{if(o)w();else return console.log("error submit!!"),!1})};return V(async()=>{f.images_upload_url=await $(),m.value=!1}),V(async()=>{e.id=parseInt(k.params.id,10),await R()}),(o,t)=>{const i=N,s=j,_=F,I=D,B=L,C=S,M=q;return n(),A("div",P,[J((n(),u(C,{ref_key:"formRef",ref:c,model:e,rules:x,"label-width":"84px",class:"mt-20"},{default:r(()=>[K("div",null,[a(s,{label:"碎片名称",prop:"name"},{default:r(()=>[a(i,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.name=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"碎片标识",prop:"mark"},{default:r(()=>[a(i,{modelValue:e.mark,"onUpdate:modelValue":t[1]||(t[1]=l=>e.mark=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"碎片类型",prop:"type"},{default:r(()=>[a(I,{modelValue:e.type,"onUpdate:modelValue":t[2]||(t[2]=l=>e.type=l),class:"ml-4"},{default:r(()=>[a(_,{label:1,value:"1"},{default:r(()=>t[5]||(t[5]=[d("富文本")])),_:1}),a(_,{label:2,value:"2"},{default:r(()=>t[6]||(t[6]=[d("文本框")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.type==1?(n(),u(s,{key:0,label:"碎片内容"},{default:r(()=>[a(W,{modelValue:e.content,"onUpdate:modelValue":t[3]||(t[3]=l=>e.content=l),setting:f,onInit:E,"script-src":"/public/admin/tinymce/tinymce.min.js"},null,8,["modelValue","setting"])]),_:1})):b("",!0),e.type==2?(n(),u(s,{key:1,label:"碎片内容"},{default:r(()=>[a(i,{type:"textarea",prop:"textarea",class:"textarea",rows:3,modelValue:e.content,"onUpdate:modelValue":t[4]||(t[4]=l=>e.content=l)},null,8,["modelValue"])]),_:1})):b("",!0)]),a(s,null,{default:r(()=>[a(B,{type:"primary",onClick:U},{default:r(()=>t[7]||(t[7]=[d("保存")])),_:1})]),_:1})]),_:1},8,["model","rules"])),[[M,m.value]])])}}},Ge=z(X,[["__scopeId","data-v-f2629c2d"]]);export{Ge as default};
