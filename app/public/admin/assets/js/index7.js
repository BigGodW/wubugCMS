import{E as g,f as S,w as T,P as j,Q as P,R as Q,M as U}from"./element-plus.js";import{a as V,u as $}from"./vue-router.js";import{H as z,E as H}from"./@element-plus.js";import{l as I,a as L}from"./field.js";import{h as A}from"./model.js";import{r,j as F,ad as G,o as y,c as J,M as t,Q as i,U as K,_ as O,R as W,u as h}from"./@vue.js";import"./lodash-es.js";import"./async-validator.js";import"./dayjs.js";import"./@popperjs.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./index.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./codemirror-wrapped-line-indent.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css        */const X={class:"bg-fff radius-6 pd-20"},Ue={__name:"index",setup(Y){const w=V(),C=$(),n=r({mid:w.query.mid}),s=r(""),c=r(""),k=r([]),p=r([]),u=r(0),d=r(1),_=r(!0),m=async()=>{try{const e=await I(n.value.mid,d.value);if(e.code===200){const o=e.data;p.value=[...o.list],s.value=o.model.model,c.value=o.model.tableName,u.value=o.count,_.value=!1}}catch(e){console.error(e)}},E=e=>{k.value=e},x=e=>{d.value=Number(e),sessionStorage.setItem("cur",Number(e)),m()},N=e=>{const{id:o,ename:a}=e;C.push({name:"field-edit",query:{fid:o,mid:n.value.mid,table:a,model:s.value}})},B=async e=>{let{id:o}=e;try{(await A(n.value.mid)).data.count===0?(await L(o)).code===200&&(g({message:"删除成功 ^_^",type:"success"}),m()):g({message:"当前模型正在使用，字段不能删除 ^_^",type:"warning"})}catch(a){console.error(a)}};return F(()=>{m()}),(e,o)=>{const a=S,f=G("router-link"),v=T,l=j,R=P,q=Q,D=U;return y(),J("div",X,[t(v,{type:"flex",justify:"end"},{default:i(()=>[t(f,{to:{name:"field-add",query:{mid:n.value.mid,table:c.value,model:s.value}}},{default:i(()=>[t(a,{type:"primary",round:""},{default:i(()=>o[0]||(o[0]=[K("新增")])),_:1})]),_:1},8,["to"])]),_:1}),O((y(),W(R,{ref:"multipleTable",data:p.value,"tooltip-effect":"dark",style:{width:"100%"},"row-key":"id",onSelectionChange:E},{default:i(()=>[t(l,{type:"selection",width:"55"}),t(l,{prop:"id",label:"编号"}),t(l,{prop:"cname",label:"中文名称"}),t(l,{prop:"ename",label:"字段名称"}),t(l,{prop:"orderBy",label:"排序"}),t(l,{fixed:"right",label:"操作",width:"150"},{default:i(b=>[t(a,{icon:h(z),circle:"",onClick:M=>N(b.row)},null,8,["icon","onClick"]),t(a,{icon:h(H),circle:"",onClick:M=>B(b.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[D,_.value]]),t(v,{type:"flex",class:"mt-20",justify:"space-between"},{default:i(()=>[t(q,{background:"",layout:"prev, pager, next",onCurrentChange:x,"page-size":10,total:u.value,"hide-on-single-page":""},null,8,["total"])]),_:1})])}}};export{Ue as default};
