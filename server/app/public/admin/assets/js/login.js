import{h as p,a as c}from"./api.js";import{_ as h,s as d}from"./index.js";import{o as u,c as g,a as e,W as n,aj as l,a7 as _,aw as f,ax as w,Y as m}from"./@vue.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";let y=({username:t,password:s})=>p({url:`${c.API_URL}/api/admin/login`,method:"post",data:{username:t,password:s}}),v=t=>p({url:`${c.API_URL}/api/captcha?v=${t}`,method:"get"}),b=t=>p({url:`${c.API_URL}/api/checkCaptcha`,method:"post",data:{captcha:t}});const k=""+new URL("../png/banner.png",import.meta.url).href;const C={name:"login-in",data:()=>({svg:"",code:"",params:{username:"",password:""}}),computed:{},created(){this.getCaptcha()},mounted(){},methods:{async getCaptcha(){try{let t=Math.random().toString().slice(4,8),s=await v(t);this.svg=s}catch(t){console.log(t)}},async checkCaptcha(){try{let t=await b(this.code);return t.code===200&&t.data?!0:(this.$message({message:"验证码不正确",type:"warning"}),!1)}catch(t){console.log(t)}},validate(){return this.params.username.length<2?(this.$message({message:"用户名不能少于2位",type:"warning"}),!1):this.params.password.length<6?(this.$message({message:"密码不能少于6位",type:"warning"}),!1):!0},async toLogin(){if(this.validate()){if(!await this.checkCaptcha())return;y({username:this.params.username,password:this.params.password}).then(o=>{if(o.code===200&&o.data){d("username",o.data.username),d("token",o.data.token),this.$router.push({name:"home-index"});return}this.$message({message:"用户名或密码错误",type:"warning"})}).catch(o=>{console.error(o)})}}}},i=t=>(f("data-v-afdc1687"),t=t(),w(),t),L={class:"ys-wrap page-login pt-160 row"},$=i(()=>e("div",{class:"login-ad mt-35 col-12"},[e("img",{src:k,alt:""})],-1)),I={class:"login-form col-12"},U=i(()=>e("div",{class:"ys-logo mb-30 text-c"},null,-1)),x={class:"w-330"},V={class:"border-b pt-8 pb-8 mb-10 pos-r"},M=i(()=>e("i",{class:"ico ico-user pos-r t-2"},null,-1)),R={class:"border-b pt-8 pb-8 mb-10 pos-r"},S=i(()=>e("i",{class:"ico ico-pass pos-r t-2"},null,-1)),T={class:"mb-10 pos-r captcha"},A=["innerHTML"],B={class:"mt-21"},P=i(()=>e("footer",{class:"ys-footer"},[e("p",{class:"f-13 c-a1a3aa text-c"},[m(" © "),e("a",{href:"http://www.chanyue.top",class:"mr-5",target:"_blank",title:"chanyue"},"www.chanyue.top"),m(" 禅悦系统 ● 位于南京 服务全国 ")])],-1));function H(t,s,o,K,N,r){return u(),g("div",null,[e("div",L,[$,e("div",I,[U,e("ul",x,[e("li",V,[M,n(e("input",{type:"text",class:"ml-10 f-14 lh-20 c-333","onUpdate:modelValue":s[0]||(s[0]=a=>t.params.username=a),placeholder:"用户名"},null,512),[[l,t.params.username]])]),e("li",R,[S,n(e("input",{type:"password",class:"ml-10 f-14 lh-20 c-333","onUpdate:modelValue":s[1]||(s[1]=a=>t.params.password=a),placeholder:"密码",onKeyup:s[2]||(s[2]=_((...a)=>r.toLogin&&r.toLogin(...a),["enter"]))},null,544),[[l,t.params.password]])]),e("li",T,[n(e("input",{type:"text",class:"f-14 lh-20 c-333 code","onUpdate:modelValue":s[3]||(s[3]=a=>t.code=a),placeholder:"请输入验证码"},null,512),[[l,t.code]]),e("span",{innerHTML:t.svg},null,8,A),e("span",{onClick:s[4]||(s[4]=(...a)=>r.getCaptcha&&r.getCaptcha(...a)),class:"see"},"看不清，换一张")]),e("li",B,[e("input",{type:"submit",onClick:s[5]||(s[5]=(...a)=>r.toLogin&&r.toLogin(...a)),class:"btn-block f-16 c-fff lh-22",value:"登录"})])])])]),P])}const rt=h(C,[["render",H],["__scopeId","data-v-afdc1687"]]);export{rt as default};
