import{h as p,a as c}from"./api.js";import{_ as h,s as m}from"./index.js";import{o as u,c as g,a as e,W as l,aj as n,a7 as _,aw as f,ax as w,Y as d}from"./@vue.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";let v=({username:t,password:s})=>p({url:`${c.API_URL}/api/admin/login`,method:"post",data:{username:t,password:s}}),y=t=>p({url:`${c.API_URL}/api/captcha?v=${t}`,method:"get"}),b=t=>p({url:`${c.API_URL}/api/checkCaptcha`,method:"post",data:{captcha:t}});const k=""+new URL("../png/banner.png",import.meta.url).href;const C={name:"login-in",data:()=>({svg:"",code:"",params:{username:"",password:""}}),computed:{},created(){this.getCaptcha()},mounted(){},methods:{async getCaptcha(){try{let t=Math.random().toString().slice(4,8),s=await y(t);this.svg=s}catch(t){console.log(t)}},async checkCaptcha(){try{let t=await b(this.code);return t.code===200&&t.data?!0:(this.$message({message:"\u9A8C\u8BC1\u7801\u4E0D\u6B63\u786E",type:"warning"}),!1)}catch(t){console.log(t)}},validate(){return this.params.username.length<2?(this.$message({message:"\u7528\u6237\u540D\u4E0D\u80FD\u5C11\u4E8E2\u4F4D",type:"warning"}),!1):this.params.password.length<6?(this.$message({message:"\u5BC6\u7801\u4E0D\u80FD\u5C11\u4E8E6\u4F4D",type:"warning"}),!1):!0},async toLogin(){if(this.validate()){if(!await this.checkCaptcha())return;v({username:this.params.username,password:this.params.password}).then(o=>{if(console.log("res--->",o),o.code===200&&o.data){m("username",o.data.username),m("token",o.data.token),this.$router.push({name:"home-index"});return}this.$message({message:"\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF",type:"warning"})}).catch(o=>{console.error(o)})}}}},i=t=>(f("data-v-25bf43e3"),t=t(),w(),t),L={class:"ys-wrap page-login pt-160 row"},$=i(()=>e("div",{class:"login-ad mt-35 col-12"},[e("img",{src:k,alt:""})],-1)),I={class:"login-form col-12"},U=i(()=>e("div",{class:"ys-logo mb-30 text-c"},null,-1)),x={class:"w-330"},V={class:"border-b pt-8 pb-8 mb-10 pos-r"},M=i(()=>e("i",{class:"ico ico-user pos-r t-2"},null,-1)),R={class:"border-b pt-8 pb-8 mb-10 pos-r"},S=i(()=>e("i",{class:"ico ico-pass pos-r t-2"},null,-1)),T={class:"mb-10 pos-r captcha"},A=["innerHTML"],B={class:"mt-21"},P=i(()=>e("footer",{class:"ys-footer"},[e("p",{class:"f-13 c-a1a3aa text-c"},[d(" \xA9 "),e("a",{href:"http://www.eggcms.top",class:"mr-5",target:"_blank",title:"yuscms"},"www.eggcms.top"),d(" eggcms\u7CFB\u7EDF \u25CF \u4F4D\u4E8E\u5357\u4EAC \u670D\u52A1\u5168\u56FD ")])],-1));function H(t,s,o,K,N,r){return u(),g("div",null,[e("div",L,[$,e("div",I,[U,e("ul",x,[e("li",V,[M,l(e("input",{type:"text",class:"ml-10 f-14 lh-20 c-333","onUpdate:modelValue":s[0]||(s[0]=a=>t.params.username=a),placeholder:"\u7528\u6237\u540D"},null,512),[[n,t.params.username]])]),e("li",R,[S,l(e("input",{type:"password",class:"ml-10 f-14 lh-20 c-333","onUpdate:modelValue":s[1]||(s[1]=a=>t.params.password=a),placeholder:"\u5BC6\u7801",onKeyup:s[2]||(s[2]=_((...a)=>r.toLogin&&r.toLogin(...a),["enter"]))},null,544),[[n,t.params.password]])]),e("li",T,[l(e("input",{type:"text",class:"f-14 lh-20 c-333 code","onUpdate:modelValue":s[3]||(s[3]=a=>t.code=a),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,512),[[n,t.code]]),e("span",{innerHTML:t.svg},null,8,A),e("span",{onClick:s[4]||(s[4]=(...a)=>r.getCaptcha&&r.getCaptcha(...a)),class:"see"},"\u770B\u4E0D\u6E05\uFF0C\u6362\u4E00\u5F20")]),e("li",B,[e("input",{type:"submit",onClick:s[5]||(s[5]=(...a)=>r.toLogin&&r.toLogin(...a)),class:"btn-block f-16 c-fff lh-22",value:"\u767B\u5F55"})])])])]),P])}const rt=h(C,[["render",H],["__scopeId","data-v-25bf43e3"]]);export{rt as default};
