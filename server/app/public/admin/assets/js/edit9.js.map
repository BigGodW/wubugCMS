{"version":3,"file":"edit9.js","sources":["../../../src/views/model/edit.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"100px\"\n      class\n    >\n      <el-form-item label=\"模型名称\" prop=\"model_name\">\n        <el-input v-model=\"params.model_name\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"新增表名\" prop=\"table_name\">\n        <el-input v-model=\"params.table_name\" :disabled=\"disable\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"是否启用\">\n        <el-radio v-model=\"params.status\" label=\"1\">开启</el-radio>\n        <el-radio v-model=\"params.status\" :disabled=\"disable\" label=\"0\"\n          >禁用</el-radio\n        >\n      </el-form-item>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { update, hasUse, detail } from \"@/api/model.js\";\nexport default {\n  name: \"model-edit\",\n  data: () => {\n    return {\n      params: {\n        //接口入参\n        id: 0,\n        old_table_name: \"\", //未修改之前的表名称\n        model_name: \"\",\n        table_name: \"\",\n        status: \"1\",\n      },\n      disable: false,\n      paramsRules: {\n        //校验规则\n        model_name: [\n          { required: true, message: \"模型名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 80,\n            message: \"名称长度在 2 到 80 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n        table_name: [\n          { required: true, message: \"新增表名\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 80,\n            message: \"名称长度在 2 到 80 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  computed: {},\n  async mounted() {},\n  async created() {\n    let id = this.$route.params.id;\n    this.params.id = id;\n    await this.detail(); // 文章详情\n    await this.hasUse(id);\n  },\n  methods: {\n    // 文章详情\n    async detail() {\n      try {\n        let res = await detail(this.params.id);\n        if (res.code === 200) {\n          let data = res.data;\n          //记老的表名，改新表名称\n          this.params = { ...data, old_table_name: data.table_name };\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    handleSubCid(e) {\n      console.log(\"e-->\", e);\n    },\n\n    handletag(e) {\n      console.log(\"e-->\", e);\n    },\n    handleBox(e) {\n      console.log(\"e-->\", e);\n    },\n\n    async hasUse(id) {\n      try {\n        let res = await hasUse(id);\n        if (res.data.count) {\n          this.disable = true;\n        } else {\n          this.disable = false;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //新增\n    async update() {\n      try {\n        let res = await update(this.params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n        }\n        this.$router.go(-1);\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.update();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","name","data","params","required","message","trigger","max","async","this","id","hasUse","methods","res","detail","code","console","error","log","e","handleSubCid","count","disable","update","$message","type","$router","go","submit","formName","$refs","validate","valid","_openBlock","_createElementBlock","ref","model","_ctx","rules","paramsRules","label","prop","modelValue","model_name","_cache","$event","table_name","disabled","status","onClick","$options"],"mappings":"ijBA+BA,MA9BOA,EAAA,CAAAC,MAAA,+BA8BP,CACEC,KAAA,aACAC,KAAA,KACE,CACEC,OAAA,oGAYI,CAAAC,UAAA,EAAAC,QAAA,OAAAC,QAAA,QACA,OAEEC,IAAA,gCAEAD,QAAA,qBAIF,CAAAF,UAAA,EAAAC,QAAA,OAAAC,QAAA,QACA,OAEEC,IAAA,gCAEAD,QAAA,wBAOVE,gBAAA,EACAA,4CAEEC,KAAAN,OAAAO,GAAAA,4BAEAD,KAAAE,OAAAD,IAEFE,QAAA,gBAGI,IACE,IAAAC,QAAAC,EAAAL,KAAAN,OAAAO,IACA,GAAA,MAAAG,EAAAE,KAAA,CACE,IAAAb,EAAAW,EAAAX,mDAGF,WAEAc,QAAAC,MAAAA,EACF,iBAIAD,QAAAE,IAAA,UAAAC,IAGFC,aAAAD,GACEH,QAAAE,IAAA,UAAAC,iBAIAH,QAAAE,IAAA,UAAAC,iBAGAH,QAAAE,IAAA,UAAAC,IAGFX,aAAAE,GACE,iBAEER,KAAAmB,MACEZ,KAAAa,SAAA,EAEAb,KAAAa,SAAA,WAGFN,QAAAE,IAAAD,EACF,kBAKA,WACEM,EAAAd,KAAAN,eAEEM,KAAAe,SAAA,CACEnB,QAAA,UACAoB,KAAA,YAGJhB,KAAAiB,QAAAC,IAAA,YAEAX,QAAAE,IAAAD,EACF,GAGFW,OAAAC,GACEpB,KAAAqB,MAAAD,GAAAE,UAAAC,IACE,IAAAA,uDAKA,kEA5IN,OAAAC,IAAAC,EAAA,MAAAnC,EAAA,MAEIoC,IAAA,SACCC,MAAAC,EAAAlC,OACAmC,MAAAD,EAAAE,YACD,cAAA,QACAvC,MAAA,0BAEcwC,MAAA,OAAaC,KAAA,oCACNC,WAAAL,EAAAlC,OAAAwC,WAAA,sBAAAC,EAAA,KAAAA,EAAA,GAAAC,GAAAR,EAAAlC,OAAAwC,WAAAE,yCAEPL,MAAA,OAAaC,KAAA,oCACNC,WAAAL,EAAAlC,OAAA2C,WAAA,sBAAAF,EAAA,KAAAA,EAAA,GAAAC,GAAAR,EAAAlC,OAAA2C,WAAAD,GAAoBE,SAAAV,EAAAf,6FAGpBoB,WAAAL,EAAAlC,OAAA6C,OAAA,sBAAAJ,EAAA,KAAAA,EAAA,GAAAC,GAAAR,EAAAlC,OAAA6C,OAAAH,GAAeL,MAAA,6DACfE,WAAAL,EAAAlC,OAAA6C,OAAA,sBAAAJ,EAAA,KAAAA,EAAA,GAAAC,GAAAR,EAAAlC,OAAA6C,OAAAH,GAAgBE,SAAAV,EAAAf,QAAmBkB,MAAA,2GAM3Cf,KAAA,UAAgBwB,QAAAL,EAAA,KAAAA,EAAA,GAAAC,GAAAK,EAAAtB,OAAA"}