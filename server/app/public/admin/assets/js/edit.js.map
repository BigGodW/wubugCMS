{"version":3,"file":"edit.js","sources":["../../../src/views/ad/edit.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"84px\"\n      class=\"mt-20\"\n    >\n      <div>\n        <el-form-item label=\"广告名称\" prop=\"title\">\n          <el-input v-model=\"params.title\" placeholder=\"请输入汉字\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告链接\">\n          <el-input v-model=\"params.link\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告标识\" prop=\"mark\">\n          <el-input v-model=\"params.mark\" disabled></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告平台\">\n          <el-radio v-model=\"params.platform\" label=\"1\">PC</el-radio>\n          <el-radio v-model=\"params.platform\" label=\"2\">H5</el-radio>\n        </el-form-item>\n\n        <el-form-item label=\"广告位置\">\n          <el-checkbox-group v-model=\"params.position\" @change=\"handleAttr\">\n            <el-checkbox label=\"1\">首页</el-checkbox>\n            <el-checkbox label=\"2\">频道页</el-checkbox>\n            <el-checkbox label=\"3\">列表页</el-checkbox>\n            <el-checkbox label=\"4\">文章页</el-checkbox>\n            <el-checkbox label=\"5\">单页</el-checkbox>\n          </el-checkbox-group>\n        </el-form-item>\n\n        <el-form-item class=\"row\" label=\"广告图片\">\n          <el-upload\n            class=\"avatar-uploader\"\n            action=\"/api/upload\"\n            :on-success=\"upload\"\n            :show-file-list=\"false\"\n            :before-upload=\"beforeUpload\"\n          >\n            <el-icon class=\"avatar-uploader-icon\"><Plus /></el-icon>\n          </el-upload>\n\n          <el-popover placement=\"right\" :width=\"400\" trigger=\"hover\">\n            <template #reference>\n              <el-image\n                class=\"avatar-uploader-icon pointer ml-10\"\n                v-if=\"params.imgUrl\"\n                :src=\"params.imgUrl\"\n              />\n            </template>\n            <el-image\n              style=\"width: 100%\"\n              v-if=\"params.imgUrl\"\n              :src=\"params.imgUrl\"\n            />\n          </el-popover>\n\n          <el-input class=\"ml-10 flex-1\" v-model=\"params.imgUrl\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"发布时间\">\n          <el-date-picker\n            v-model=\"params.createdAt\"\n            type=\"datetime\"\n            placeholder=\"选择日期时间\"\n          ></el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"是否显示\">\n          <el-radio v-model=\"params.status\" label=\"1\">发布</el-radio>\n          <el-radio v-model=\"params.status\" label=\"2\">不发布</el-radio>\n        </el-form-item>\n      </div>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { update, detail } from \"@/api/ad.js\";\nimport { Plus } from \"@element-plus/icons-vue\";\nexport default {\n  name: \"ad-edit\",\n  data: () => {\n    return {\n      params: {\n        //接口入参\n        id: 0,\n        title: \"\",\n        mark: \"\",\n        imgUrl: \"\",\n        link: \"\",\n        platform: \"\",\n        position: [1, 2],\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        status: \"1\",\n      },\n      disabled: false,\n      paramsRules: {\n        //校验规则\n        title: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n        mark: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  components: {\n    Plus,\n  },\n  async mounted() {},\n\n  async created() {\n    this.params.id = this.$route.params.id;\n    await this.detail(); // 文章详情\n  },\n  methods: {\n    // 文章详情\n    async detail() {\n      try {\n        let res = await detail(this.params.id);\n        if (res.code === 200) {\n          let params = res.data;\n          params.position = params.position.split(\",\");\n          params.platform = params.status.toString();\n          params.status = params.status.toString();\n          params.updatedAt = new Date(params.createdAt);\n          this.params = params;\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    beforeUpload(rawFile) {\n      if (rawFile.size / 1024 / 1024 > 2) {\n        this.$message(\"上传文件必须小于1M\");\n        return false;\n      }\n    },\n\n    //上传缩略图\n    upload(res) {\n      if (res.code === 200) {\n        this.params.imgUrl = res.data.path;\n      }\n    },\n\n    //新增\n    async update() {\n      try {\n        let params = { ...this.params };\n        params.position = params.position.toString();\n        let res = await update(params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.update();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","name","data","params","title","mark","imgUrl","link","position","createdAt","Date","updatedAt","disabled","max","trigger","mounted","created","this","id","$route","methods","res","detail","code","split","platform","status","toString","console","error","log","e","beforeUpload","rawFile","path","$message","message","type","$router","go","submit","formName","$refs","validate","valid","_openBlock","_createElementBlock","ref","model","_ctx","rules","paramsRules","label","prop","modelValue","_cache","$event","placeholder","onChange","$options","handleAttr","action","upload","placement","width","reference","_withCtx","style","onClick"],"mappings":"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"}