{"version":3,"file":"edit.js","sources":["../../../src/views/ad/edit.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"84px\"\n      class=\"mt-20\"\n    >\n      <div>\n        <el-form-item label=\"广告名称\" prop=\"title\">\n          <el-input v-model=\"params.title\" placeholder=\"请输入汉字\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告链接\">\n          <el-input v-model=\"params.link\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告标识\" prop=\"mark\">\n          <el-input v-model=\"params.mark\" disabled></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告平台\">\n          <el-radio v-model=\"params.platform\" label=\"1\">PC</el-radio>\n          <el-radio v-model=\"params.platform\" label=\"2\">H5</el-radio>\n        </el-form-item>\n\n        <el-form-item label=\"广告位置\">\n          <el-checkbox-group v-model=\"params.position\" @change=\"handleAttr\">\n            <el-checkbox label=\"1\">首页</el-checkbox>\n            <el-checkbox label=\"2\">频道页</el-checkbox>\n            <el-checkbox label=\"3\">列表页</el-checkbox>\n            <el-checkbox label=\"4\">文章页</el-checkbox>\n            <el-checkbox label=\"5\">单页</el-checkbox>\n          </el-checkbox-group>\n        </el-form-item>\n\n        <el-form-item label=\"图片链接\">\n          <el-input v-model=\"params.imgUrl\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告图片\">\n          <el-upload\n            class=\"avatar-uploader\"\n            action=\"/api/upload\"\n            :on-success=\"upload\"\n            :show-file-list=\"false\"\n            :before-upload=\"beforeUpload\"\n          >\n            <el-image\n              style=\"width: 100%\"\n              v-if=\"params.imgUrl\"\n              :src=\"params.imgUrl\"\n            />\n            <el-icon v-else class=\"avatar-uploader-icon\"><Plus /></el-icon>\n          </el-upload>\n        </el-form-item>\n\n        <el-form-item label=\"发布时间\">\n          <el-date-picker\n            v-model=\"params.createdAt\"\n            type=\"datetime\"\n            placeholder=\"选择日期时间\"\n          ></el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"是否显示\">\n          <el-radio v-model=\"params.status\" label=\"1\">发布</el-radio>\n          <el-radio v-model=\"params.status\" label=\"2\">不发布</el-radio>\n        </el-form-item>\n      </div>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { update, detail } from \"@/api/ad.js\";\nimport { Plus } from \"@element-plus/icons-vue\";\nexport default {\n  name: \"ad-edit\",\n  data: () => {\n    return {\n      params: {\n        //接口入参\n        id: 0,\n        title: \"\",\n        mark: \"\",\n        imgUrl: \"\",\n        link: \"\",\n        platform: \"\",\n        position: [1, 2],\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        status: \"1\",\n      },\n      disabled: false,\n      paramsRules: {\n        //校验规则\n        title: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n        mark: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  components: {\n    Plus,\n  },\n  async mounted() {},\n\n  async created() {\n    this.params.id = this.$route.params.id;\n    await this.detail(); // 文章详情\n  },\n  methods: {\n    // 文章详情\n    async detail() {\n      try {\n        let res = await detail(this.params.id);\n        if (res.code === 200) {\n          let params = res.data;\n          params.position = params.position.split(\",\");\n          params.platform = params.status.toString();\n          params.status = params.status.toString();\n          params.updatedAt = new Date(params.createdAt);\n          this.params = params;\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    beforeUpload(rawFile) {\n      if (rawFile.size / 1024 / 1024 > 2) {\n        this.$message(\"上传文件必须小于1M\");\n        return false;\n      }\n    },\n\n    //上传缩略图\n    upload(res) {\n      if (res.code === 200) {\n        this.params.imgUrl = res.data.path;\n      }\n    },\n\n    //新增\n    async update() {\n      try {\n        let params = { ...this.params };\n        params.position = params.position.toString();\n        let res = await update(params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.update();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","name","data","params","title","mark","imgUrl","link","position","createdAt","Date","updatedAt","disabled","max","trigger","async","this","id","$route","methods","res","detail","code","split","platform","status","toString","console","error","log","e","beforeUpload","rawFile","path","$message","message","type","$router","go","submit","formName","$refs","validate","valid","_openBlock","_createElementBlock","ref","model","_ctx","rules","paramsRules","label","prop","modelValue","_cache","$event","placeholder","onChange","$options","handleAttr","action","upload","style","width","onClick"],"mappings":"0oBAkFA,MAjFOA,EAAA,CAAAC,MAAA,+BAiFP,CACEC,KAAA,UACAC,KAAA,KACE,CACEC,OAAA,MAGEC,MAAA,GACAC,KAAA,GACAC,OAAA,GACAC,KAAA,eAEAC,SAAA,CAAA,EAAA,GACAC,cAAAC,KACAC,cAAAD,iBAGFE,UAAA,eAGER,MAAA,gDAEE,OAEES,IAAA,gCAEAC,QAAA,8DAKF,OAEED,IAAA,gCAEAC,QAAA,gCASVC,gBAAA,EAEAA,gBACEC,KAAAb,OAAAc,GAAAD,KAAAE,OAAAf,OAAAc,wBAGFE,QAAA,gBAGI,IACE,IAAAC,QAAAC,EAAAL,KAAAb,OAAAc,IACA,GAAA,MAAAG,EAAAE,KAAA,CACE,IAAAnB,EAAAiB,EAAAlB,KACAC,EAAAK,SAAAL,EAAAK,SAAAe,MAAA,KACApB,EAAAqB,SAAArB,EAAAsB,OAAAC,WACAvB,EAAAsB,OAAAtB,EAAAsB,OAAAC,WACAvB,EAAAQ,UAAA,IAAAD,KAAAP,EAAAM,WACAO,KAAAb,OAAAA,CACF,WAEAwB,QAAAC,MAAAA,EACF,iBAIAD,QAAAE,IAAA,UAAAC,IAGFC,aAAAC,0EASE,MAAAZ,EAAAE,OACEN,KAAAb,OAAAG,OAAAc,EAAAlB,KAAA+B,sBAMF,2BAEE9B,EAAAK,SAAAL,EAAAK,SAAAkB,+BAGEV,KAAAkB,SAAA,CACEC,QAAA,UACAC,KAAA,YAEFpB,KAAAqB,QAAAC,IAAA,aAGFX,QAAAE,IAAAD,EACF,GAGFW,OAAAC,GACExB,KAAAyB,MAAAD,GAAAE,UAAAC,IACE,IAAAA,uDAKA,sGAhMN,OAAAC,IAAAC,EAAA,MAAA9C,EAAA,MAEI+C,IAAA,SACCC,MAAAC,EAAA7C,OACA8C,MAAAD,EAAAE,YACD,cAAA,OACAlD,MAAA,6CAGgBmD,MAAA,OAAaC,KAAA,+BACNC,WAAAL,EAAA7C,OAAAC,MAAA,sBAAAkD,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAC,MAAAmD,GAAcC,YAAA,kFAIdH,WAAAL,EAAA7C,OAAAI,KAAA,sBAAA+C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAI,KAAAgD,yCAGPJ,MAAA,OAAaC,KAAA,8BACNC,WAAAL,EAAA7C,OAAAE,KAAA,sBAAAiD,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAE,KAAAkD,GAAa3C,SAAA,6EAIbyC,WAAAL,EAAA7C,OAAAqB,SAAA,sBAAA8B,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAqB,SAAA+B,GAAiBJ,MAAA,6DACjBE,WAAAL,EAAA7C,OAAAqB,SAAA,sBAAA8B,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAqB,SAAA+B,GAAiBJ,MAAA,0GAIRE,WAAAL,EAAA7C,OAAAK,SAAA,sBAAA8C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAK,SAAA+C,GAAkBE,SAAAC,EAAAC,iXAU3BN,WAAAL,EAAA7C,OAAAG,OAAA,sBAAAgD,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAG,OAAAiD,6EAKjBvD,MAAA,kBACA4D,OAAA,cACC,aAAAF,EAAAG,OACA,kBAAA,EACA,gBAAAH,EAAA3B,+BAIOiB,EAAA7C,OAAAG,uBADNwD,MAAA,CAAAC,MAAA,8DAIc/D,MAAA,oJAMPqD,WAAAL,EAAA7C,OAAAM,UAAA,sBAAA6C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAM,UAAA8C,GACTnB,KAAA,WACAoB,YAAA,mFAKiBH,WAAAL,EAAA7C,OAAAsB,OAAA,sBAAA6B,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAsB,OAAA8B,GAAeJ,MAAA,6DACfE,WAAAL,EAAA7C,OAAAsB,OAAA,sBAAA6B,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAsB,OAAA8B,GAAeJ,MAAA,mGAKzBf,KAAA,UAAgB4B,QAAAV,EAAA,MAAAA,EAAA,IAAAC,GAAAG,EAAAnB,OAAA"}