import{m as W,n as X,x as Y,t as h,s as ee,I as le,J as te,H as ae,R as oe,f as re,r as se,E as b}from"./element-plus.js";import{r as m,I as ne,j as ue,o as p,c as g,a as V,M as a,Q as r,_ as w,O as U,a8 as E,R as x,u as de,U as u,$ as k,V as ie}from"./@vue.js";import{a as me,u as pe}from"./vue-router.js";import{v as L}from"./sys_config.js";import{f as fe,c as Ve}from"./category.js";import{a as ye,t as ve,s as be}from"./index.js";import{l as ge}from"./model.js";import{p as ce}from"./pinyin-pro.js";import"./lodash-es.js";import"./async-validator.js";import"./dayjs.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./codemirror-wrapped-line-indent.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css        */const _e={class:"bg-fff radius-6 pd-20"},we={class:"mr-10 ml-10"},Ue={class:"mr-10 ml-10 mb-20"},il={__name:"add",setup(Ee){me();const P=pe(),S=m(null),C=m([]),d=m(""),N={checkStrictly:!0},B=m("first"),y=m(0),c=m([]),R=m([]),T=m([]),t=ne({pid:0,seoTitle:"",seoKeywords:"",seoDescription:"",name:"",path:"",pinyin:"",mid:0,description:"",url:"",orderBy:0,type:0,target:0,status:0,articleView:"article.html",listView:"list.html"}),O=o=>{t.pinyin=ce(o,{toneType:"none"}).replace(/\s+/g,""),t.path=d.value?d.value+t.pinyin:"/"+d.value+t.pinyin},j=o=>{t.path=d.value?d.value+o:"/"+d.value+o},A=o=>{y.value=parseInt(o.index)},F=async()=>{try{const o=await fe();if(o.code===200){const e=ye(ve(o.data));c.value=e}}catch(o){console.log(o)}},K=async()=>{try{const o=await L();o.code===200&&(T.value=o.data.filter(e=>!["404.html","500.html"].includes(e)).map(e=>({label:e,value:e})))}catch(o){console.log(o)}},M=o=>{let e=[];Object.values(o).forEach(_=>{c.value.forEach(v=>{v.id===_&&e.push("/"+v.pinyin)})}),d.value=e.join("")+"/",t.path=d.value+t.pinyin,o[0]!==-1&&(t.pid=o[o.length-1])},$=async()=>{try{const o=await ge();o.code===200&&(R.value=o.data.list)}catch(o){console.log(o)}},q=async()=>{try{const o=await Ve(t);o.code===200?(b({message:"更新成功^_^",type:"success"}),P.go(-1)):b({message:o.msg,type:"error"})}catch(o){console.log(o)}},z=()=>t.pinyin==="article"?(b({message:"不能使用article作为拼音",type:"error"}),!1):/^[a-zA-Z][a-zA-Z0-9]*$/.test(t.pinyin)?!0:(b({message:"拼音只能包含26个字母和数字，且首字母不能是数字",type:"error"}),!1),Z=o=>{o.validate((e,f)=>{e?z()&&q():be(f)})};return ue(()=>{F(),K(),$()}),(o,e)=>{const f=W,_=X,v=Y,s=h,n=ee,I=le,D=te,i=ae,G=oe,H=re,J=se;return p(),g("div",_e,[V("div",we,[a(_,{modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=l=>B.value=l),onTabClick:A},{default:r(()=>[a(f,{label:"基本信息",name:"first"}),a(f,{label:"SEO设置",name:"second"}),a(f,{label:"扩展信息",name:"third"})]),_:1},8,["modelValue"])]),V("div",Ue,[a(J,{ref_key:"paramsRef",ref:S,model:t,"label-width":"84px"},{default:r(()=>[w(V("div",null,[a(s,{label:"上级栏目"},{default:r(()=>[a(v,{props:N,"show-all-levels":!1,modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=l=>C.value=l),options:c.value,onChange:M,placeholder:"不选择为顶级栏目"},null,8,["modelValue","options"])]),_:1}),a(s,{label:"栏目名称",prop:"name",rules:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:1,max:50,message:"栏目不能超过50个字",trigger:"blur"}]},{default:r(()=>[a(n,{modelValue:t.name,"onUpdate:modelValue":e[2]||(e[2]=l=>t.name=l),onChange:O},null,8,["modelValue"])]),_:1}),a(s,{label:"栏目标识"},{default:r(()=>[a(n,{modelValue:t.pinyin,"onUpdate:modelValue":e[3]||(e[3]=l=>t.pinyin=l),onChange:j,placeholder:"注：首页请填写home"},null,8,["modelValue"])]),_:1}),a(s,{label:"栏目路径"},{default:r(()=>[a(n,{modelValue:t.path,"onUpdate:modelValue":e[4]||(e[4]=l=>t.path=l),disabled:""},null,8,["modelValue"])]),_:1}),a(s,{label:"列表模板"},{default:r(()=>[a(D,{modelValue:t.listView,"onUpdate:modelValue":e[5]||(e[5]=l=>t.listView=l),placeholder:"Select"},{default:r(()=>[(p(!0),g(U,null,E(T.value,l=>(p(),x(I,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"内容模板"},{default:r(()=>[a(D,{modelValue:t.articleView,"onUpdate:modelValue":e[6]||(e[6]=l=>t.articleView=l),placeholder:"Select"},{default:r(()=>[(p(!0),g(U,null,E(de(L),l=>(p(),x(I,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"栏目类型"},{default:r(()=>[a(i,{modelValue:t.type,"onUpdate:modelValue":e[7]||(e[7]=l=>t.type=l),label:0},{default:r(()=>e[21]||(e[21]=[u("栏目")])),_:1},8,["modelValue"]),a(i,{modelValue:t.type,"onUpdate:modelValue":e[8]||(e[8]=l=>t.type=l),label:1},{default:r(()=>e[22]||(e[22]=[u("单页")])),_:1},8,["modelValue"])]),_:1}),a(s,{label:"是否显示"},{default:r(()=>[a(i,{modelValue:t.status,"onUpdate:modelValue":e[9]||(e[9]=l=>t.status=l),label:0},{default:r(()=>e[23]||(e[23]=[u("显示")])),_:1},8,["modelValue"]),a(i,{modelValue:t.status,"onUpdate:modelValue":e[10]||(e[10]=l=>t.status=l),label:1},{default:r(()=>e[24]||(e[24]=[u("隐藏")])),_:1},8,["modelValue"])]),_:1})],512),[[k,y.value===0]]),w(V("div",null,[a(s,{label:"seo标题"},{default:r(()=>[a(n,{modelValue:t.seoTitle,"onUpdate:modelValue":e[11]||(e[11]=l=>t.seoTitle=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"seo关键词"},{default:r(()=>[a(n,{modelValue:t.seoKeywords,"onUpdate:modelValue":e[12]||(e[12]=l=>t.seoKeywords=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"seo描述"},{default:r(()=>[a(n,{type:"textarea",prop:"textarea",rows:2,modelValue:t.seoDescription,"onUpdate:modelValue":e[13]||(e[13]=l=>t.seoDescription=l)},null,8,["modelValue"])]),_:1})],512),[[k,y.value===1]]),w(V("div",null,[a(s,{label:"栏目链接"},{default:r(()=>[a(n,{modelValue:t.url,"onUpdate:modelValue":e[14]||(e[14]=l=>t.url=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"扩展模型"},{default:r(()=>[a(G,{modelValue:t.mid,"onUpdate:modelValue":e[15]||(e[15]=l=>t.mid=l)},{default:r(()=>[a(i,{label:0},{default:r(()=>e[25]||(e[25]=[u("基本模型")])),_:1}),(p(!0),g(U,null,E(R.value,(l,Q)=>(p(),x(i,{key:Q,label:l.id},{default:r(()=>[u(ie(l.model),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"打开方式"},{default:r(()=>[a(i,{modelValue:t.target,"onUpdate:modelValue":e[16]||(e[16]=l=>t.target=l),label:0},{default:r(()=>e[26]||(e[26]=[u("当前页面")])),_:1},8,["modelValue"]),a(i,{modelValue:t.target,"onUpdate:modelValue":e[17]||(e[17]=l=>t.target=l),label:1},{default:r(()=>e[27]||(e[27]=[u("新页面")])),_:1},8,["modelValue"])]),_:1}),a(s,{label:"栏目排序"},{default:r(()=>[a(n,{modelValue:t.orderBy,"onUpdate:modelValue":e[18]||(e[18]=l=>t.orderBy=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"栏目描述"},{default:r(()=>[a(n,{type:"textarea",prop:"textarea",rows:2,modelValue:t.description,"onUpdate:modelValue":e[19]||(e[19]=l=>t.description=l)},null,8,["modelValue"])]),_:1})],512),[[k,y.value===2]]),a(s,null,{default:r(()=>[a(H,{type:"primary",onClick:e[20]||(e[20]=l=>Z(S.value))},{default:r(()=>e[28]||(e[28]=[u("保存")])),_:1})]),_:1})]),_:1},8,["model"])])])}}};export{il as default};
