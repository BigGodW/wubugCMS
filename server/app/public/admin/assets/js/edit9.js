import{E as i,s as w,t as U,H as R,f as I,r as q}from"./element-plus.js";import{u as B,a as C}from"./vue-router.js";import{d as M,h as j,u as F}from"./model.js";import{_ as T}from"./index.js";import{r as c,I as _,j as h,o as D,c as H,M as r,Q as l,U as u}from"./@vue.js";import"./lodash-es.js";import"./async-validator.js";import"./dayjs.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vanilla-jsoneditor.js";import"./json-source-map.js";import"./@jsonquerylang.js";import"./@fortawesome.js";import"./natural-compare-lite.js";import"./@codemirror.js";import"./@lezer.js";import"./crelt.js";import"./style-mod.js";import"./w3c-keyname.js";import"./@replit.js";import"./codemirror-wrapped-line-indent.js";import"./fast-deep-equal.js";import"./fast-uri.js";import"./jmespath.js";import"./jsonpath-plus.js";import"./immutable-json-patch.js";import"./jsonrepair.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css        */const O={class:"bg-fff pd-20 radius-6"},Q={__name:"edit",setup(S){const b=B(),g=C(),n=c(null),o=_({id:0,old_tableName:"",model:"",tableName:"",remark:"",status:1}),p=c(!1),d=_({model:[{required:!0,message:"请输入模型名称",trigger:"blur"}],tableName:[{required:!0,message:"请输入表名",trigger:"blur"},{validator:V,trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]});function V(t,e,s){e.startsWith("ext_")?s():s(new Error("表名必须以 ext_ 开头"))}const N=async()=>{try{const t=await M(o.id);if(t.code===200){const e=t.data;Object.assign(o,{...e,old_tableName:e.tableName})}else i.error(t.msg)}catch(t){console.error(t)}},k=async t=>{try{const e=await j(t);e.code===200?p.value=e.data.count>0:i.error(e.msg)}catch(e){console.error(e)}},v=async()=>{try{const t=await F(o);t.code===200?(i.success("更新成功^_^"),b.go(-1)):i.error(t.msg)}catch(t){console.error(t)}},y=()=>{n.value.validate(t=>{if(t)v();else return console.log("error submit!!"),!1})};return h(async()=>{const t=g.params.id;o.id=t,await N(),await k(t)}),(t,e)=>{const s=w,m=U,f=R,x=I,E=q;return D(),H("div",O,[r(E,{ref_key:"formRef",ref:n,model:o,"label-width":"100px",class:"mt-20"},{default:l(()=>[r(m,{label:"模型名称",prop:"model",rules:d.model},{default:l(()=>[r(s,{modelValue:o.model,"onUpdate:modelValue":e[0]||(e[0]=a=>o.model=a),placeholder:"请输入模型名称"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,{label:"新增表名",prop:"tableName",rules:d.tableName},{default:l(()=>[r(s,{modelValue:o.tableName,"onUpdate:modelValue":e[1]||(e[1]=a=>o.tableName=a),placeholder:"表名称必须ext_开头"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,{label:"是否启用"},{default:l(()=>[r(f,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=a=>o.status=a),label:1},{default:l(()=>e[5]||(e[5]=[u("开启")])),_:1},8,["modelValue"]),r(f,{modelValue:o.status,"onUpdate:modelValue":e[3]||(e[3]=a=>o.status=a),disabled:p.value,label:0},{default:l(()=>e[6]||(e[6]=[u("禁用")])),_:1},8,["modelValue","disabled"])]),_:1}),r(m,{label:"备注",prop:"remark",rules:d.remark},{default:l(()=>[r(s,{modelValue:o.remark,"onUpdate:modelValue":e[4]||(e[4]=a=>o.remark=a),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,null,{default:l(()=>[r(x,{type:"primary",onClick:y},{default:l(()=>e[7]||(e[7]=[u("保存")])),_:1})]),_:1})]),_:1},8,["model"])])}}},we=T(Q,[["__scopeId","data-v-f8623772"]]);export{we as default};
