import{a as N,b as $,u as T}from"./category.js";import{_ as q,b as E,a as P,t as D}from"./index.js";import{l as F}from"./model.js";import{E as R}from"./pinyin-pro.js";import{ag as m,o as u,c as b,a as V,Z as t,V as o,F as y,W as h,_ as U,U as v,Y as r,g as k,a6 as j,t as A}from"./@vue.js";import"./api.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";const O={name:"category-edit",data:()=>({id:0,categorySelected:[],categoryProps:{checkStrictly:!0},activeName:"first",activeIndex:"0",category:[],modList:[],params:{pid:0,seo_title:"",seo_keywords:"",seo_description:"",name:"",pinyin:"",path:"",mid:"0",description:"",url:"",sort:0,type:"0",target:"0",status:"0"},paramsRules:{name:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:10,message:"名称长度在 2 到 10 个字符之间",trigger:"blur"}]}}),computed:{},watch:{"params.name":function(e,a){this.params.pinyin=R(e,{toneType:"none"}).replace(/\s+/g,"");let n=this.params.path.split("/");n.length=n.length-1,n.push(this.params.pinyin),this.params.path=n.join("/")}},created(){this.id=this.$route.params.id,this.modelList(),this.query(),this.findById()},methods:{handleClick(e){this.activeIndex=e.index},async query(){try{let e=await N();if(e.code===200){let a=e.data,p=E(this.id,a);p.length>1&&(p.length=p.length-1),this.categorySelected=p;let n=P(D(a));this.category=[...n]}}catch(e){console.log(e)}},async modelList(){try{let e=await F(this.cur);e.code===200&&(this.modList=e.data.list.map(a=>(a.id=a.id.toString(),a)))}catch(e){console.log(e)}},async findById(){try{let e=await $(this.id);e.code===200&&(this.params=e.data)}catch(e){console.error(e)}},handleChange(e){e[0]!=-1&&(this.params.pid=e[e.length-1])},async update(){try{(await T(this.params)).code&&(this.$message({message:"更新成功^_^",type:"success"}),this.$router.go(-1))}catch(e){console.log(e)}},submit(e){this.params.path=this.allPath,this.$refs[e].validate(a=>{if(a)this.update();else return console.log("error submit!!"),!1})}}},W={class:"mr-10 ml-10"},Y={class:"mr-10 ml-10 mb-20"};function Z(e,a,p,n,z,f){const g=m("el-tab-pane"),w=m("el-tabs"),C=m("el-cascader"),s=m("el-form-item"),d=m("el-input"),i=m("el-radio"),S=m("el-radio-group"),I=m("el-button"),L=m("el-form");return u(),b(y,null,[V("div",W,[t(w,{modelValue:e.activeName,"onUpdate:modelValue":a[0]||(a[0]=l=>e.activeName=l),onTabClick:f.handleClick},{default:o(()=>[t(g,{label:"基本信息",name:"first"}),t(g,{label:"SEO设置",name:"second"})]),_:1},8,["modelValue","onTabClick"])]),V("div",Y,[t(L,{ref:"params",model:e.params,rules:e.paramsRules,"label-width":"84px",class:"w640"},{default:o(()=>[h(V("div",null,[!e.params.pid==0?(u(),v(s,{key:0,label:"上级栏目"},{default:o(()=>[t(C,{props:e.categoryProps,"show-all-levels":!1,disabled:!0,modelValue:e.categorySelected,"onUpdate:modelValue":a[1]||(a[1]=l=>e.categorySelected=l),options:e.category,onChange:f.handleChange},null,8,["props","modelValue","options","onChange"]),r(" 不选择为顶级栏目 ")]),_:1})):k("",!0),t(s,{label:"栏目名称",prop:"name"},{default:o(()=>[t(d,{modelValue:e.params.name,"onUpdate:modelValue":a[2]||(a[2]=l=>e.params.name=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"栏目标识"},{default:o(()=>[t(d,{modelValue:e.params.pinyin,"onUpdate:modelValue":a[3]||(a[3]=l=>e.params.pinyin=l),disabled:""},null,8,["modelValue"])]),_:1}),t(s,{label:"栏目路径"},{default:o(()=>[t(d,{modelValue:e.params.path,"onUpdate:modelValue":a[4]||(a[4]=l=>e.params.path=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"栏目类型"},{default:o(()=>[t(i,{modelValue:e.params.type,"onUpdate:modelValue":a[5]||(a[5]=l=>e.params.type=l),label:"0"},{default:o(()=>[r("栏目")]),_:1},8,["modelValue"]),t(i,{modelValue:e.params.type,"onUpdate:modelValue":a[6]||(a[6]=l=>e.params.type=l),label:"1"},{default:o(()=>[r("单页")]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"扩展模型"},{default:o(()=>[t(S,{modelValue:e.params.mid,"onUpdate:modelValue":a[7]||(a[7]=l=>e.params.mid=l)},{default:o(()=>[t(i,{label:"0"},{default:o(()=>[r("基本模型")]),_:1}),e.modList.length>0?(u(!0),b(y,{key:0},j(e.modList,(l,B)=>(u(),v(i,{key:B,label:l.id},{default:o(()=>[r(A(l.model_name)+"模型 ",1)]),_:2},1032,["label"]))),128)):k("",!0)]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"是否显示"},{default:o(()=>[t(i,{modelValue:e.params.status,"onUpdate:modelValue":a[8]||(a[8]=l=>e.params.status=l),label:"0"},{default:o(()=>[r("显示")]),_:1},8,["modelValue"]),t(i,{modelValue:e.params.status,"onUpdate:modelValue":a[9]||(a[9]=l=>e.params.status=l),label:"1"},{default:o(()=>[r("隐藏")]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"栏目排序"},{default:o(()=>[t(d,{modelValue:e.params.sort,"onUpdate:modelValue":a[10]||(a[10]=l=>e.params.sort=l)},null,8,["modelValue"])]),_:1})],512),[[U,e.activeIndex==0]]),h(V("div",null,[t(s,{label:"栏目描述"},{default:o(()=>[t(d,{modelValue:e.params.description,"onUpdate:modelValue":a[11]||(a[11]=l=>e.params.description=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"栏目链接"},{default:o(()=>[t(d,{modelValue:e.params.url,"onUpdate:modelValue":a[12]||(a[12]=l=>e.params.url=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"打开方式"},{default:o(()=>[t(i,{modelValue:e.params.target,"onUpdate:modelValue":a[13]||(a[13]=l=>e.params.target=l),label:"0"},{default:o(()=>[r("当前页面")]),_:1},8,["modelValue"]),t(i,{modelValue:e.params.target,"onUpdate:modelValue":a[14]||(a[14]=l=>e.params.target=l),label:"1"},{default:o(()=>[r("新页面")]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"seo标题"},{default:o(()=>[t(d,{modelValue:e.params.seo_title,"onUpdate:modelValue":a[15]||(a[15]=l=>e.params.seo_title=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"seo关键词"},{default:o(()=>[t(d,{modelValue:e.params.seo_keywords,"onUpdate:modelValue":a[16]||(a[16]=l=>e.params.seo_keywords=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"seo描述"},{default:o(()=>[t(d,{modelValue:e.params.seo_description,"onUpdate:modelValue":a[17]||(a[17]=l=>e.params.seo_description=l)},null,8,["modelValue"])]),_:1})],512),[[U,e.activeIndex==1]]),t(s,null,{default:o(()=>[t(I,{type:"primary",onClick:a[18]||(a[18]=l=>f.submit("params"))},{default:o(()=>[r("保存")]),_:1})]),_:1})]),_:1},8,["model","rules"])])],64)}const ue=q(O,[["render",Z]]);export{ue as default};
