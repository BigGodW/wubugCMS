{"version":3,"file":"add10.js","sources":["../../../src/views/page/add.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10\">\n    <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\n      <el-tab-pane label=\"基本信息\" name=\"first\"></el-tab-pane>\n      <el-tab-pane label=\"扩展信息\" name=\"second\"></el-tab-pane>\n    </el-tabs>\n  </div>\n\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"84px\"\n      class\n    >\n      <div v-show=\"activeIndex == 0\">\n        <el-form-item label=\"文章栏目\">\n          <el-cascader\n            :props=\"categoryProps\"\n            :show-all-levels=\"false\"\n            v-model=\"categorySelected\"\n            :options=\"category\"\n            @change=\"handleChange\"\n          ></el-cascader>\n        </el-form-item>\n\n        <el-form-item label=\"文章标题\" prop=\"title\">\n          <el-input v-model=\"params.title\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"文章内容\">\n          <vue3-tinymce\n            v-model=\"params.content\"\n            :setting=\"setting\"\n            script-src=\"/public/admin/tinymce/tinymce.min.js\"\n          />\n        </el-form-item>\n\n        <el-form-item label=\"内容功能\">\n          <el-checkbox v-model=\"autoImg\">\n            提取第\n            <el-input\n              v-model=\"picNum\"\n              class=\"w-80 mr-8 ml-8\"\n              placeholder=\"请输入内容\"\n            ></el-input\n            >张图片作封面\n          </el-checkbox>\n          <el-checkbox v-model=\"autoDes\">提取文章描述</el-checkbox>\n        </el-form-item>\n\n        <el-form-item label=\"发布时间\">\n          <el-date-picker\n            v-model=\"params.createdAt\"\n            :default-value=\"new Date()\"\n            type=\"datetime\"\n            placeholder=\"选择日期时间\"\n          ></el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"是否显示\">\n          <el-radio v-model=\"params.status\" label=\"0\">发布</el-radio>\n          <el-radio v-model=\"params.status\" label=\"1\">不发布</el-radio>\n        </el-form-item>\n\n        <el-form-item label=\"浏览数\">\n          <el-input v-model=\"params.pv\"></el-input>\n        </el-form-item>\n      </div>\n\n      <div v-show=\"activeIndex == 1\">\n        <el-form-item label=\"SEO标题\">\n          <el-input v-model=\"params.seo_title\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"SEO关键词\">\n          <el-input v-model=\"params.seo_keywords\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"SEO描述\">\n          <el-input v-model=\"params.seo_description\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"来源\">\n          <el-input v-model=\"params.source\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"作者\">\n          <el-input v-model=\"params.author\"></el-input>\n        </el-form-item>\n      </div>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { find } from \"@/api/category.js\";\nimport { create } from \"@/api/page.js\";\nimport { addLabelValue, filterBody, tree } from \"@/utils/tool.js\";\nimport Vue3Tinymce from \"@jsdawn/vue3-tinymce\";\nimport { tinymceSet } from \"@/config/tinymce.js\";\n\nexport default {\n  name: \"page-add\",\n  components: {\n    Vue3Tinymce,\n  },\n  data: () => {\n    return {\n      setting: tinymceSet,\n\n      categorySelected: [], //-1默认选中顶级栏目\n      categoryProps: { checkStrictly: true },\n      activeName: \"first\", //tab 默认显示第一个\n      activeIndex: \"0\", //tab 内容默认显示第一个\n\n      category: [], //当前所有栏目\n      cateList: [], //所有栏目\n      autoImg: true,\n      autoDes: true,\n      picNum: 1,\n\n      params: {\n        //接口入参\n        cid: 0,\n        title: \"\",\n        seo_title: \"\",\n        seo_keywords: \"\",\n        seo_description: \"\",\n        source: \"\",\n        author: \"\",\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        content: \"禅悦\",\n        status: \"0\",\n        pv: 0,\n      },\n      paramsRules: {\n        //校验规则\n        title: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  computed: {},\n  mounted() {},\n  created() {\n    this.query();\n  },\n  unmounted() {},\n  methods: {\n    handleClick(tab) {\n      this.activeIndex = tab.index;\n    },\n    setContent(article) {\n      this.params.content = article;\n    },\n    //查询\n    async query() {\n      try {\n        let res = await find();\n        if (res.code === 200) {\n          let dataTree = addLabelValue(tree(res.data));\n          let data = addLabelValue(res.data);\n          this.cateList = data;\n          this.category = [...dataTree];\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //选择栏目\n    handleChange(e) {\n      if (e[0] != -1) {\n        this.params.cid = e[e.length - 1];\n      }\n    },\n\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    handleSubCid(e) {\n      console.log(\"e-->\", e);\n    },\n\n    changeContent(e) {\n      this.params.content = e;\n    },\n\n    //新增\n    async create() {\n      try {\n        let res = await create(this.params);\n        if (res.code == 200) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          console.log(this.params);\n          this.create();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","_hoisted_2","name","data","setting","tinymceSet","categorySelected","categoryProps","checkStrictly","activeName","category","cateList","picNum","params","title","seo_keywords","seo_description","source","author","createdAt","Date","updatedAt","max","trigger","created","methods","handleClick","tab","setContent","article","res","find","code","dataTree","addLabelValue","tree","this","console","log","error","handleChange","e","handleSubCid","changeContent","content","create","$message","message","type","$router","go","submit","formName","$refs","validate","valid","_createElementVNode","onTabClick","$options","label","ref","model","_ctx","rules","paramsRules","props","options","onChange","prop","modelValue","_cache","$event","placeholder","status","pv","seo_title","onClick"],"mappings":"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"}