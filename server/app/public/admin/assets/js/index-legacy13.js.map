{"version":3,"file":"index-legacy13.js","sources":["../../../src/views/model/index.vue"],"sourcesContent":["<template>\n  <el-row type=\"flex\" class=\"mt-10 mb-10\" justify=\"end\">\n    <router-link to=\"/model/add\">\n      <el-button type=\"primary\" round>新增</el-button>\n    </router-link>\n  </el-row>\n\n  <el-table\n    ref=\"multipleTable\"\n    :data=\"tableData\"\n    tooltip-effect=\"dark\"\n    row-key=\"id\"\n    size=\"small\"\n    @selection-change=\"handleSelectionChange\"\n    v-loading=\"loading\"\n  >\n    <el-table-column type=\"selection\"></el-table-column>\n    <el-table-column prop=\"id\" width=\"60\" label=\"编号\"></el-table-column>\n    <el-table-column prop=\"model_name\" label=\"模型名称\"></el-table-column>\n    <el-table-column prop=\"table_name\" label=\"模型对应的表\"></el-table-column>\n    <el-table-column prop=\"status\" label=\"状态\">\n      <template #default=\"scope\">{{\n        scope.row.status == 1 ? \"启用\" : \"禁用\"\n      }}</template>\n    </el-table-column>\n    <el-table-column fixed=\"right\" width=\"136\" label=\"操作\">\n      <template #default=\"scope\">\n        <el-button\n          :icon=\"View\"\n          circle\n          @click=\"handleClick(scope.row)\"\n        ></el-button>\n        <el-button :icon=\"Edit\" circle @click=\"toEdit(scope.row)\"></el-button>\n        <el-button\n          :icon=\"Delete\"\n          circle\n          @click=\"handleDel(scope.row)\"\n        ></el-button>\n      </template>\n    </el-table-column>\n  </el-table>\n\n  <!-- 分页 -->\n  <el-row type=\"flex\" class=\"mt-20 align-c\" justify=\"center\">\n    <el-pagination\n      background\n      layout=\"prev, pager, next\"\n      @current-change=\"handleCurrentChange\"\n      :pager-size=\"10\"\n      :total=\"count\"\n      hide-on-single-page\n    ></el-pagination>\n  </el-row>\n</template>\n\n<script>\nimport { Delete, Edit, View, Search } from \"@element-plus/icons-vue\";\nimport { list, hasUse, del } from \"@/api/model.js\";\nexport default {\n  name: \"model-index\",\n  setup() {\n    return {\n      Edit,\n      Delete,\n      View,\n      Search,\n    };\n  },\n  data: () => {\n    return {\n      multipleSelection: [],\n      tableData: [],\n      count: 0,\n      cur: 1,\n      loading: true,\n    };\n  },\n  computed: {},\n  created() {\n    this.list();\n  },\n  update() {},\n  methods: {\n    //查询\n    async list() {\n      try {\n        let res = await list(this.cur);\n        if (res.code === 200) {\n          this.tableData = [...res.data.list];\n          this.count = res.data.count;\n          this.loading = false;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach((row) => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n\n    //翻页\n    handleCurrentChange(e) {\n      this.cur = Number(e);\n      sessionStorage.setItem(\"cur\", Number(e));\n      this.list();\n    },\n\n    async hasUse(id) {\n      return await hasUse(id);\n    },\n\n    //跳转到编辑\n    toEdit(e) {\n      let id = e.id;\n      this.$router.push({ name: \"model-edit\", params: { id: id } });\n    },\n\n    // 查看字段\n    handleClick(e) {\n      console.log(\"e--->\", e);\n      const { id } = e;\n      this.$router.push({ name: \"field-index\", query: { mid: id } });\n    },\n\n    //删除文章\n    async handleDel(e) {\n      const { id, table_name } = e;\n      try {\n        let res = await this.hasUse(id);\n        if (res.data.count == 0) {\n          let res = await del(id, table_name);\n          if (res.code === 200) {\n            this.$message({\n              message: \"删除成功 ^_^\",\n              type: \"error\",\n            });\n            this.list();\n          }\n        } else {\n          this.$message({\n            message: \"当前模型已经使用，不能删除！\",\n            type: \"error\",\n          });\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n  },\n};\n</script>\n<style scoped>\n.el-input {\n  width: 200px !important;\n}\n</style>\n"],"names":["name","setup","Delete","Search","data","multipleSelection","count","created","methods","res","code","this","tableData","list","loading","console","log","error","toggleSelection","rows","forEach","row","$refs","multipleTable","clearSelection","cur","Number","e","sessionStorage","setItem","async","hasUse","id","toEdit","handleClick","del","table_name","$message","message","type","class","justify","round","ref","_ctx","size","onSelectionChange","$options","handleSelectionChange","prop","width","label","fixed","icon","$setup","View","circle","onClick","$event","scope","Edit","handleDel","background","layout","onCurrentChange","handleCurrentChange","total"],"mappings":"u/BA0DA,CACEA,KAAA,cACAC,MAAAA,KACE,QAEEC,OAAAA,SAEAC,OAAAA,IAGJC,KAAAA,KACE,CACEC,kBAAA,gBAEAC,MAAA,iCAMJC,kCAIAC,QAAA,cAGI,4BAEE,MAAAC,EAAAC,OACEC,KAAAC,UAAA,IAAAH,EAAAL,KAAAS,8BAEAF,KAAAG,SAAA,YAGFC,QAAAC,IAAAC,EACF,GAGFC,gBAAAC,GACEA,EACEA,EAAAC,SAAAC,sDAIAV,KAAAW,MAAAC,cAAAC,4FAUFb,KAAAc,IAAAC,OAAAC,GACAC,eAAAC,QAAA,MAAAH,OAAAC,iBAIFG,OAAAC,MAAAC,SACED,EAAAC,GAIFC,OAAAN,oEAMAO,YAAAP,kGAOAG,gBAAAH,8BAEE,IAEE,0BAAAvB,KAAAE,MAEE,aADA6B,EAAAH,EAAAI,IACA1B,OACEC,KAAA0B,SAAA,CACEC,QAAA,uCAMJ3B,KAAA0B,SAAA,kDAMFtB,QAAAC,IAAAC,EACF,iHA5JIsB,KAAA,OAAYC,MAAA,cAAoBC,QAAA,oEAEzBF,KAAA,UAAeG,MAAA,oEAK5BC,IAAA,gBACCvC,KAAAwC,EAAAhC,UACD,iBAAA,OACA,UAAA,KACAiC,KAAA,QACCC,kBAAAC,EAAAC,qEAIgBC,KAAA,KAAUC,MAAA,KAAWC,MAAA,YACrBF,KAAA,aAAkBE,MAAA,cAClBF,KAAA,aAAkBE,MAAA,gBAClBF,KAAA,SAAcE,MAAA,sEAKdC,MAAA,QAAcF,MAAA,MAAYC,MAAA,2BAGpCE,KAAAC,EAAAC,KACDC,OAAA,GACCC,QAAAC,GAAAX,EAAAb,YAAAyB,EAAAtC,sCAESgC,KAAAC,EAAAM,KAAYJ,OAAA,GAAQC,QAAAC,GAAAX,EAAAd,OAAA0B,EAAAtC,sCAE7BgC,KAAAC,EAAApD,OACDsD,OAAA,GACCC,QAAAC,GAAAX,EAAAc,UAAAF,EAAAtC,yGAODkB,KAAA,OAAYC,MAAA,gBAAsBC,QAAA,gCAEtCqB,WAAA,GACAC,OAAA,oBACCC,gBAAAjB,EAAAkB,oBACA,aAAA,GACAC,MAAAtB,EAAAtC,MACD,sBAAA"}