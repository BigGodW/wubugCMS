{"version":3,"file":"index-legacy14.js","sources":["../../../src/views/page/index.vue"],"sourcesContent":["<template>\n  <!-- 搜索区域 -->\n  <div class=\"search row justify-between align-c pt-10 pl-20 pr-20 pb-20 mb-20\">\n    <el-form :inline=\"true\" :model=\"params\" ref=\"form\">\n      <el-form-item class=\"mt-10\" label=\"标题\" prop=\"keywords\">\n        <el-input\n          class=\"mr-10 w-auto\"\n          placeholder=\"请输入内容\"\n          :suffix-icon=\"Search\"\n          v-model=\"params.keywords\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item class=\"mt-10\">\n        <el-button type=\"primary\" @click=\"search\" round>搜索</el-button>\n        <el-button @click=\"clearSearch('form')\" round>清空</el-button>\n      </el-form-item>\n    </el-form>\n    <router-link class=\"mt-10\" to=\"/page/add\">\n      <el-button type=\"primary\" round>新增</el-button>\n    </router-link>\n  </div>\n\n  <el-table\n    ref=\"multipleTable\"\n    :data=\"tableData\"\n    tooltip-effect=\"dark\"\n    row-key=\"id\"\n    size=\"small\"\n    @selection-change=\"handleSelectionChange\"\n    v-loading=\"loading\"\n  >\n    <el-table-column type=\"selection\"></el-table-column>\n    <el-table-column prop=\"id\" label=\"编号\" width=\"60\"></el-table-column>\n    <el-table-column prop=\"title\" label=\"标题\"></el-table-column>\n    <el-table-column prop=\"name\" label=\"所属栏目\" width=\"80\"></el-table-column>\n    <!-- <el-table-column prop=\"pv\" label=\"浏览次数\"></el-table-column> -->\n    <el-table-column prop=\"createdAt\" label=\"发布时间\" width=\"160\">\n      <template #default=\"scope\">{{ scope.row.createdAt }}</template>\n    </el-table-column>\n    <el-table-column prop=\"status\" label=\"状态\" width=\"60\">\n      <template #default=\"scope\">{{\n        scope.row.status == 0 ? \"显示\" : \"隐藏\"\n      }}</template>\n    </el-table-column>\n    <el-table-column fixed=\"right\" label=\"操作\" width=\"150\">\n      <template #default=\"scope\">\n        <el-button\n          :icon=\"View\"\n          circle\n          @click=\"handleClick(scope.row)\"\n        ></el-button>\n        <el-button :icon=\"Edit\" circle @click=\"toEdit(scope.row)\"></el-button>\n        <el-button\n          :icon=\"Delete\"\n          circle\n          @click=\"handleDel(scope.row)\"\n        ></el-button>\n      </template>\n    </el-table-column>\n  </el-table>\n\n  <!-- 分页 -->\n  <el-row type=\"flex\" class=\"mt-20\" justify=\"space-between\">\n    <div style=\"margin-top: 20px\">\n      批量操作：\n      <el-button @click=\"delSome\">删除</el-button>\n    </div>\n    <el-pagination\n      background\n      layout=\"prev, pager, next\"\n      @current-change=\"handleCurrentChange\"\n      :pager-size=\"10\"\n      :total=\"count\"\n      hide-on-single-page\n    ></el-pagination>\n  </el-row>\n</template>\n\n<script>\nimport { Delete, Edit, View, Search } from \"@element-plus/icons-vue\";\nimport { search, del } from \"@/api/page.js\";\n\nexport default {\n  name: \"page-index\",\n  setup() {\n    return {\n      Edit,\n      Delete,\n      View,\n      Search,\n    };\n  },\n  data: () => {\n    return {\n      params: {\n        keywords: \"\",\n      },\n      tableData: [],\n      multipleSelection: [],\n      count: 0,\n      cur: 1,\n      loading: true,\n    };\n  },\n  computed: {},\n  created() {\n    this.search();\n  },\n  methods: {\n    //清空搜索\n    clearSearch(str) {\n      if (str) {\n        this.$refs.form.resetFields();\n      }\n      this.params.keywords = \"\";\n      this.tableData = [];\n      this.multipleSelection = [];\n      this.count = 0;\n      this.cur = 1;\n      this.search();\n    },\n\n    //查询\n    async search() {\n      try {\n        let res = await search(this.cur, this.params.keywords);\n        if (res.code === 200) {\n          this.tableData = [...res.data.list];\n          this.count = res.data.count;\n          this.loading = false;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //翻页\n    handleCurrentChange(e) {\n      this.cur = e;\n      this.search();\n    },\n\n    //全选\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach((row) => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n\n    //选择\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n\n    //编辑\n    toEdit(e) {\n      let id = e.id;\n      this.$router.push({ name: \"page-edit\", params: { id: id } });\n    },\n\n    delSome() {\n      let ids = this.multipleSelection.map((item) => {\n        return item.id;\n      });\n\n      this.$confirm(\"此操作将永久删除, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(async () => {\n          let res = await del(ids.join(\",\"));\n          if (res.code === 200) {\n            this.$message({\n              message: \"删除成功 ^_^\",\n              type: \"success\",\n            });\n            this.search();\n          }\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消删除\",\n          });\n        });\n    },\n\n    //删除\n    async handleDel(e) {\n      let id = e.id;\n      try {\n        let res = await del(id);\n        if (res.code === 200) {\n          this.$message({\n            message: \"删除成功 ^_^\",\n            type: \"success\",\n          });\n          this.search();\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n  },\n};\n</script>\n<style scoped>\n:deep(.el-form-item) {\n  margin-bottom: 0px;\n}\n</style>\n"],"names":["_hoisted_1","class","_hoisted_2","style","name","setup","Delete","Search","data","params","multipleSelection","count","created","methods","clearSearch","str","this","tableData","res","code","list","loading","console","log","error","toggleSelection","rows","forEach","row","$refs","multipleTable","clearSelection","toEdit","e","delSome","ids","map","item","$confirm","cancelButtonText","type","then","async","del","join","$message","message","id","_createElementVNode","inline","model","_ctx","ref","label","prop","placeholder","$setup","modelValue","keywords","_cache","$event","onClick","$options","search","round","to","size","onSelectionChange","handleSelectionChange","width","fixed","icon","View","circle","handleClick","scope","Edit","handleDel","justify","background","layout","onCurrentChange","handleCurrentChange","total"],"mappings":"qgCAEOA,EAAA,CAAAC,MAAA,oEA6DEC,EAAA,CAAAC,MAAA,CAAA,aAAA,uBAmBT,CACEC,KAAA,aACAC,MAAAA,KACE,QAEEC,OAAAA,SAEAC,OAAAA,IAGJC,KAAAA,KACE,CACEC,OAAA,2BAIAC,kBAAA,GACAC,MAAA,iCAMJC,yBAGAC,QAAA,CAEEC,YAAAC,GACEA,yDAIAC,KAAAC,UAAA,mFASA,iDAEE,MAAAC,EAAAC,OACEH,KAAAC,UAAA,IAAAC,EAAAV,KAAAY,8BAEAJ,KAAAK,SAAA,YAGFC,QAAAC,IAAAC,EACF,oDAUFC,gBAAAC,GACEA,EACEA,EAAAC,SAAAC,sDAIAZ,KAAAa,MAAAC,cAAAC,qEAUJC,OAAAC,mEAKAC,UACE,IAAAC,EAAAnB,KAAAN,kBAAA0B,KAAAC,UAIArB,KAAAsB,SAAA,kBAAA,KAAA,wBAEEC,iBAAA,KACAC,KAAA,YAEAC,MAAAC,UAEE,aADAC,EAAAR,EAAAS,KAAA,OACAzB,OACEH,KAAA6B,SAAA,CACEC,QAAA,WACAN,KAAA,0BAGJ,gBAGAxB,KAAA6B,SAAA,aAEEC,QAAA,SACF,KAKNJ,gBAAAT,cAEE,IAEE,aADAU,EAAAI,IACA5B,OACEH,KAAA6B,SAAA,CACEC,QAAA,WACAN,KAAA,oCAKJlB,QAAAC,IAAAC,EACF,wHA5MJwB,EAAA,MAAAhD,EAAA,MACYiD,QAAA,EAAeC,MAAAC,EAAA1C,OAAe2C,IAAA,8BACxBnD,MAAA,QAAcoD,MAAA,KAAWC,KAAA,kCAEnCrD,MAAA,eACAsD,YAAA,QACC,cAAAC,EAAAjD,OACQkD,WAAAN,EAAA1C,OAAAiD,SAAA,sBAAAC,EAAA,KAAAA,EAAA,GAAAC,GAAAT,EAAA1C,OAAAiD,SAAAE,4FAIApB,KAAA,UAAgBqB,QAAAC,EAAAC,OAAeC,MAAA,yDAC9BH,QAAAF,EAAA,KAAAA,EAAA,GAAAC,GAAAE,EAAAhD,YAAA,SAA4BkD,MAAA,yEAG/B/D,MAAA,QAAcgE,GAAA,mCACdzB,KAAA,UAAewB,MAAA,6DAK5BZ,IAAA,gBACC5C,KAAA2C,EAAAlC,UACD,iBAAA,OACA,UAAA,KACAiD,KAAA,QACCC,kBAAAL,EAAAM,qEAIgBd,KAAA,KAAUD,MAAA,KAAWgB,MAAA,YACrBf,KAAA,QAAaD,MAAA,YACbC,KAAA,OAAYD,MAAA,OAAagB,MAAA,YAEzBf,KAAA,YAAiBD,MAAA,OAAagB,MAAA,6DAG9Bf,KAAA,SAAcD,MAAA,KAAWgB,MAAA,sEAKzBC,MAAA,QAAcjB,MAAA,KAAWgB,MAAA,4BAGnCE,KAAAf,EAAAgB,KACDC,OAAA,GACCZ,QAAAD,GAAAT,EAAAuB,YAAAC,EAAA/C,sCAES2C,KAAAf,EAAAoB,KAAYH,OAAA,GAAQZ,QAAAD,GAAAE,EAAA9B,OAAA2C,EAAA/C,sCAE7B2C,KAAAf,EAAAlD,OACDmE,OAAA,GACCZ,QAAAD,GAAAE,EAAAe,UAAAF,EAAA/C,yGAODY,KAAA,OAAYvC,MAAA,QAAc6E,QAAA,kCAChC9B,EAAA,MAAA9C,EAAA,6FAKE6E,WAAA,GACAC,OAAA,oBACCC,gBAAAnB,EAAAoB,oBACA,aAAA,GACAC,MAAAhC,EAAAxC,MACD,sBAAA"}