{"version":3,"file":"edit-legacy11.js","sources":["../../../src/views/tag/edit.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"84px\"\n      class\n    >\n      <div>\n        <el-form-item label=\"标签名称\" prop=\"name\">\n          <el-input v-model=\"params.name\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"标签标识\">\n          <el-input v-model=\"params.path\" disabled></el-input>\n        </el-form-item>\n      </div>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { update, detail, has } from \"@/api/tag.js\";\nimport { pinyin } from \"pinyin-pro\";\nexport default {\n  name: \"tag-edit\",\n\n  data: () => {\n    return {\n      params: {\n        //接口入参\n        id: 0,\n        name: 0,\n        path: \"\",\n      },\n\n      paramsRules: {\n        //校验规则\n        name: [\n          { required: true, message: \"请输入标签名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 8,\n            message: \"名称长度在 2 到 8 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  computed: {},\n  async mounted() {},\n  watch: {\n    \"params.name\": function (newv, oldv) {\n      this.params.path = pinyin(newv, { toneType: \"none\" }).replace(/\\s+/g, \"\");\n    },\n  },\n  async created() {\n    this.params.id = this.$route.params.id;\n    await this.detail();\n  },\n  unmounted() {},\n  methods: {\n    // 文章详情\n    async detail() {\n      try {\n        let res = await detail(this.params.id);\n        if (res.code === 200) {\n          this.params = res.data;\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    //新增\n    async update() {\n      try {\n        let res = await update(this.params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    async has() {\n      try {\n        let res = await has(this.params.path);\n        if (res.code) {\n          if (res.data) {\n            this.$message({\n              message: \"标签已存在，修改无效\",\n              type: \"success\",\n            });\n          } else {\n            this.update();\n          }\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.has();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","name","data","params","path","trigger","async","watch","newv","oldv","this","pinyin","toneType","replace","id","$route","detail","methods","res","code","console","error","update","$message","message","type","$router","go","log","has","submit","formName","$refs","validate","valid","_openBlock","_createElementBlock","ref","model","_ctx","rules","paramsRules","label","prop","modelValue","_cache","$event","disabled","onClick","$options"],"mappings":"uxBA6BA,MA5BOA,EAAA,CAAAC,MAAA,mCA4BP,CACEC,KAAA,WAEAC,KAAAA,KACE,CACEC,OAAA,MAGEF,KAAA,EACAG,KAAA,sEAOE,yCAIEC,QAAA,wBAOVC,gBAAA,EACAC,MAAA,CACE,cAAA,SAAAC,EAAAC,GACEC,KAAAP,OAAAC,KAAAO,EAAAH,EAAA,CAAAI,SAAA,SAAAC,QAAA,OAAA,MAGJP,gBACEI,KAAAP,OAAAW,GAAAJ,KAAAK,OAAAZ,OAAAW,SACAJ,KAAAM,wBAGFC,QAAA,gBAGI,IACE,IAAAC,QAAAF,EAAAN,KAAAP,OAAAW,IACA,MAAAI,EAAAC,OACET,KAAAP,OAAAe,EAAAhB,eAGFkB,QAAAC,MAAAA,EACF,kBAIA,WACEC,EAAAZ,KAAAP,gBAEEO,KAAAa,SAAA,CACEC,QAAA,UACAC,KAAA,YAEFf,KAAAgB,QAAAC,IAAA,aAGFP,QAAAQ,IAAAP,EACF,eAGA,IACE,IAAAH,QAAAW,EAAAnB,KAAAP,OAAAC,sBAGIM,KAAAa,SAAA,CACEC,QAAA,aACAC,KAAA,oCAONL,QAAAQ,IAAAP,EACF,GAEFS,OAAAC,GACErB,KAAAsB,MAAAD,GAAAE,UAAAC,IACE,IAAAA,oDAKA,8DArHN,OAAAC,IAAAC,EAAA,MAAArC,EAAA,MAEIsC,IAAA,SACCC,MAAAC,EAAApC,OACAqC,MAAAD,EAAAE,YACD,cAAA,OACAzC,MAAA,wCAGgB0C,MAAA,OAAaC,KAAA,8BACNC,WAAAL,EAAApC,OAAAF,KAAA,sBAAA4C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAApC,OAAAF,KAAA6C,6EAIAF,WAAAL,EAAApC,OAAAC,KAAA,sBAAAyC,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAApC,OAAAC,KAAA0C,GAAaC,SAAA,qEAKvBtB,KAAA,UAAgBuB,QAAAH,EAAA,KAAAA,EAAA,GAAAC,GAAAG,EAAAnB,OAAA"}