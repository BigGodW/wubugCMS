!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(t,n,o){return(n=function(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||"default");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}System.register(["./@vue-legacy.js"],(function(e,t){"use strict";var o,r,i,a,u,c,l,s,d,f,p,m;return{setters:[function(e){o=e.r,r=e.w,i=e.b,a=e.d,u=e.e,c=e.f,l=e.o,s=e.c,d=e.a,f=e.t,p=e.g,m=e.F}],execute:function(){var t=function(e){return e+"_"+(Date.now()+Math.floor(1e6*Math.random()))},y=function(){var e="undefined"!=typeof window?window:global;return e&&"tinymce"in e?e.tinymce:null};function b(e){return e?e.getContent():""}function g(e,t){t&&t.setContent(e)}function v(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&e.mode.set(t?"readonly":"design")}function h(e,t,n){return new Promise((function(o,r){var i,a,u=e||{},c=u.images_upload_url,l=u.images_upload_credentials,s=u.custom_images_upload_header,d=u.custom_images_upload_param,f=u.custom_images_upload_callback;(i=new XMLHttpRequest).withCredentials=!!l,i.open("POST",c||""),s&&Object.keys(s).forEach((function(e){i.setRequestHeader(e,s[e])})),i.upload.onprogress=function(e){n(e.loaded/e.total*100)},i.onload=function(){if(403!==i.status)if(i.status<200||i.status>=300)r("HTTP Error: "+i.status);else{var e=JSON.parse(i.responseText);if(e){var t="function"==typeof f?f(e):e.location;t?o(t):r("Failed Path: location image path is error/empty")}else r("Invalid JSON: "+i.responseText)}else r({message:"HTTP Error: "+i.status,remove:!0})},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},(a=new FormData).append("file",t.blob(),t.filename()),d&&Object.keys(d).forEach((function(e){a.append(e,d[e])})),i.send(a)}))}var O,j,w=(O={status:{},loadedCallbacks:{}},j=function(e){O.loadedCallbacks[e]&&(O.loadedCallbacks[e].forEach((function(e){"function"==typeof e.handler&&e.handler.call(e.scope)})),O.loadedCallbacks[e]=void 0)},{load:function(e,n,o){n&&(O.loadedCallbacks[e]||(O.loadedCallbacks[e]=[]),O.loadedCallbacks[e].push({handler:n,scope:o||globalThis})),"LOADED"!==O.status[e]?"LOADING"!==O.status[e]&&(O.status[e]="LOADING",function(e,n){var o=document.createElement("script");o.id=t("tiny-script"),o.type="application/javascript",o.src=e,o.referrerPolicy="origin",o.addEventListener("load",(function e(){o.removeEventListener("load",e),n()})),(document.head||document.body).appendChild(o)}(e,(function(){O.status[e]="LOADED",j(e)}))):j(e)}}),_=["id"],S={key:0},C={name:"Vue3Tinymce"},P=e("_",Object.assign(C,{props:{modelValue:String,setting:{type:Object,default:function(){return{}}},setup:Function,disabled:Boolean,scriptSrc:String,debug:Boolean},emits:["update:modelValue","init","change"],setup:function(e,O){var j=O.expose,C=O.emit,P=e,D=!0,E=o({editor:null,id:t("tinymce"),err:""}),k=function(){var e;return String(null!=(e=P.modelValue)?e:"")},T=function(e,t,n){P.debug&&console.log("来自：".concat(e.type," | \n ").concat(t," \n ").concat(n||"--"))},x=function(e,t){t||(t=E.editor);var n=b(t);T(e,n),C("update:modelValue",n),C("change",n)},L=function(){var e;if(null!==y()){P.debug&&console.warn("vue3-tinymce 进入debug模式");var t,o=n(n({},P.setting),{},{selector:"#".concat(E.id),content_style:(t=null==(e=P.setting)?void 0:e.content_style,"body{font-size: 14px;} img{padding: 0 2px;} "+(t||"")),setup:function(e){E.editor=e,P.setup&&P.setup(e),e.on("init",(function(){return function(e){g(k(),e),P.disabled&&"readonly"!==e.mode.get()&&v(e),e.on("change input undo redo",(function(t){x(t,e)})),C("init",e)}(e)}))}});P.setting.custom_images_upload&&(o.images_upload_handler=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.apply(null,[P.setting].concat(t))}),y().init(o),D=!1}else E.err="tinymce is null"};return r((function(){return P.modelValue}),(function(e,t){if(E.editor&&E.editor.initialized&&t!==e&&e!==b(E.editor)){if(T({type:"propsChanged to setContent"},e,t),null===e)return function(e,t){if(t){if(t.resetContent)return t.resetContent(e);t.setContent(e),t.setDirty(!1),t.undoManager.clear()}}("",E.editor);g(k(),E.editor)}})),r((function(){return P.disabled}),(function(e){E.editor&&E.editor.initialized&&v(E.editor,e)})),j({id:E.id,editor:E.editor}),i((function(){var e;if(null===y()){var t=null!=(e=P.scriptSrc)?e:"https://cdn.bootcdn.net/ajax/libs/tinymce/6.1.2/tinymce.min.js";w.load(t,L)}else L()})),a((function(){D||L()})),u((function(){var e;E.editor&&(null==(e=y())||e.remove("#".concat(E.id)))})),c((function(){var e;E.editor&&(null==(e=y())||e.remove("#".concat(E.id)))})),function(e,t){return l(),s(m,null,[d("div",{id:E.id,class:"tiny-textarea"},null,8,_),E.err?(l(),s("p",S,f(E.err),1)):p("",!0)],64)}}}));P.install=function(e){e.component("Vue3Tinymce",P)}}}}))}();
