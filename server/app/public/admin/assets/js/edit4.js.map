{"version":3,"file":"edit4.js","sources":["../../../src/views/field/edit.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"100px\"\n      class=\"mt-20\"\n    >\n      <el-form-item label=\"中文名称\" prop=\"field_cname\">\n        <el-input v-model=\"params.field_cname\"></el-input>\n      </el-form-item>\n\n      <el-form-item label=\"英文名称\" prop=\"field_ename\">\n        <el-input v-model=\"params.field_ename\" :disabled=\"disable\"></el-input>\n      </el-form-item>\n\n      <el-form-item label=\"字段类型\">\n        <el-select\n          v-model=\"params.field_type\"\n          :disabled=\"disable\"\n          placeholder=\"请选择\"\n        >\n          <el-option\n            v-for=\"item in type\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          >\n          </el-option>\n        </el-select>\n      </el-form-item>\n\n      <el-form-item label=\"字段选项\">\n        <el-input v-model=\"params.field_values\"></el-input>\n      </el-form-item>\n\n      <el-form-item label=\"默认值\">\n        <el-input v-model=\"params.field_default\"></el-input>\n      </el-form-item>\n\n      <el-form-item label=\"排序\">\n        <el-input v-model=\"params.field_sort\"></el-input>\n      </el-form-item>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { update, detail } from \"@/api/field.js\";\nimport { hasUse } from \"@/api/model.js\";\nexport default {\n  name: \"field-edit\",\n  data: () => {\n    return {\n      params: {\n        //接口入参\n        id: \"\",\n        model_id: \"\",\n        table_name: \"\",\n        field_cname: \"\",\n        field_ename: \"\",\n        field_type: \"\",\n        field_values: \"\",\n        field_default: \"\",\n        field_sort: \"0\",\n      },\n\n      type: [\n        {\n          value: \"1\",\n          label: \"单行文本\",\n        },\n        {\n          value: \"2\",\n          label: \"多行文本 \",\n        },\n        {\n          value: \"3\",\n          label: \"下拉菜单\",\n        },\n        {\n          value: \"4\",\n          label: \"单选\",\n        },\n        {\n          value: \"5\",\n          label: \"多选 \",\n        },\n        {\n          value: \"6\",\n          label: \"时间和日期 \",\n        },\n        {\n          value: \"7\",\n          label: \"数字 \",\n        },\n      ],\n      disable: true,\n      value: \"\",\n      paramsRules: {\n        //校验规则\n        field_cname: [\n          { required: true, message: \"字段名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 80,\n            message: \"名称长度在 2 到 80 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n        table_name: [\n          { required: true, message: \"新增表名\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 80,\n            message: \"名称长度在 2 到 80 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  computed: {},\n  async mounted() {},\n  async created() {\n    console.log(\"this.$route.query\", this.$route.query);\n    const { model_name, fid, mid, table_name } = this.$route.query;\n    this.params.id = fid;\n    this.params.model_id = mid;\n    this.params.table_name = table_name;\n    this.model_name = model_name;\n    await this.detail(); // 文章详情\n  },\n  methods: {\n    async hasUse(id) {\n      try {\n        let res = await hasUse(id);\n        if (res.data.has.length > 0) {\n          this.disable = true;\n        } else {\n          this.disable = false;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    // 文章详情\n    async detail() {\n      try {\n        let res = await detail(this.params.id);\n        if (res.code === 200) {\n          let data = res.data;\n          //记老的表名，改新表名称\n          this.params = data;\n          this.hasUse(data.model_id);\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    handleSubCid(e) {\n      console.log(\"e-->\", e);\n    },\n\n    handletag(e) {\n      console.log(\"e-->\", e);\n    },\n    handleBox(e) {\n      console.log(\"e-->\", e);\n    },\n\n    //新增\n    async update() {\n      try {\n        let res = await update(this.params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n        }\n        this.$router.go(-1);\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.update();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","name","data","params","field_cname","field_ename","field_values","field_default","field_sort","value","required","message","trigger","max","mounted","created","this","id","fid","table_name","methods","hasUse","disable","console","log","error","res","detail","code","e","handleSubCid","update","$message","type","$router","go","submit","formName","$refs","validate","valid","_openBlock","_createElementBlock","ref","model","_ctx","rules","paramsRules","label","prop","modelValue","_cache","$event","disabled","field_type","placeholder","onClick","$options"],"mappings":"6nBAuDA,MAtDOA,EAAA,CAAAC,MAAA,+BAsDP,CACEC,KAAA,aACAC,KAAA,KACE,CACEC,OAAA,iCAKEC,YAAA,GACAC,YAAA,iBAEAC,aAAA,GACAC,cAAA,GACAC,WAAA,WAIA,CACEC,MAAA,kBAGF,CACEA,MAAA,mBAGF,CACEA,MAAA,kBAGF,CACEA,MAAA,gBAGF,CACEA,MAAA,iBAGF,CACEA,MAAA,oBAGF,CACEA,MAAA,6BAKJA,MAAA,6BAII,CAAAC,UAAA,EAAAC,QAAA,OAAAC,QAAA,QACA,OAEEC,IAAA,gCAEAD,QAAA,qBAIF,CAAAF,UAAA,EAAAC,QAAA,OAAAC,QAAA,QACA,OAEEC,IAAA,gCAEAD,QAAA,wBAOV,aAAAE,GAAA,EACA,aAAAC,qHAGEC,KAAAb,OAAAc,GAAAC,yBAEAF,KAAAb,OAAAgB,WAAAA,yCAIFC,QAAA,CACE,YAAAC,CAAAJ,GACE,mCAGID,KAAAM,SAAA,EAEAN,KAAAM,SAAA,WAGFC,QAAAC,IAAAC,EACF,kBAIA,IACE,IAAAC,QAAAC,EAAAX,KAAAb,OAAAc,IACA,GAAA,MAAAS,EAAAE,KAAA,CACE,IAAA1B,EAAAwB,EAAAxB,KAEAc,KAAAb,OAAAD,yBAEF,WAEAqB,QAAAE,MAAAA,EACF,iBAIAF,QAAAC,IAAA,UAAAK,IAGF,YAAAC,CAAAD,GACEN,QAAAC,IAAA,UAAAK,iBAIAN,QAAAC,IAAA,UAAAK,iBAGAN,QAAAC,IAAA,UAAAK,mBAKA,WACEE,EAAAf,KAAAb,eAEEa,KAAAgB,SAAA,CACErB,QAAA,UACAsB,KAAA,YAGJjB,KAAAkB,QAAAC,IAAA,YAEAZ,QAAAC,IAAAC,EACF,GAGF,MAAAW,CAAAC,GACErB,KAAAsB,MAAAD,GAAAE,UAAAC,IACE,IAAAA,uDAKA,sEA3MN,OAAAC,IAAAC,EAAA,MAAA3C,EAAA,MAEI4C,IAAA,SACCC,MAAAC,EAAA1C,OACA2C,MAAAD,EAAAE,YACD,cAAA,QACA/C,MAAA,+BAEcgD,MAAA,OAAaC,KAAA,qCACNC,WAAAL,EAAA1C,OAAAC,YAAA,sBAAA+C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA1C,OAAAC,YAAAgD,yCAGPJ,MAAA,OAAaC,KAAA,qCACNC,WAAAL,EAAA1C,OAAAE,YAAA,sBAAA8C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA1C,OAAAE,YAAA+C,GAAqBC,SAAAR,EAAAvB,6FAK7B4B,WAAAL,EAAA1C,OAAAmD,WAAA,sBAAAH,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA1C,OAAAmD,WAAAF,GACRC,SAAAR,EAAAvB,QACDiC,YAAA,kOAaiBL,WAAAL,EAAA1C,OAAAG,aAAA,sBAAA6C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA1C,OAAAG,aAAA8C,4EAIAF,WAAAL,EAAA1C,OAAAI,cAAA,sBAAA4C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA1C,OAAAI,cAAA6C,2EAIAF,WAAAL,EAAA1C,OAAAK,WAAA,sBAAA2C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA1C,OAAAK,WAAA4C,mEAIRnB,KAAA,UAAgBuB,QAAAL,EAAA,KAAAA,EAAA,GAAAC,GAAAK,EAAArB,OAAA"}