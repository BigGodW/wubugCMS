{"version":3,"file":"index15.js","sources":["../../../src/views/tag/index.vue"],"sourcesContent":["<template>\n  <!-- 搜索区域 -->\n  <div class=\"search row justify-between align-c pt-10 pl-20 pr-20 pb-20 mb-20\">\n    <el-form :inline=\"true\" :model=\"params\" ref=\"form\">\n      <el-form-item class=\"mt-10\" label=\"标题\" prop=\"keywords\">\n        <el-input\n          class=\"mr-10 w-auto\"\n          placeholder=\"请输入内容\"\n          :suffix-icon=\"Search\"\n          clearable\n          @clear=\"clearSearch\"\n          v-model=\"params.keywords\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item class=\"mt-10\">\n        <el-button type=\"primary\" @click=\"search\" round>搜索</el-button>\n        <el-button @click=\"clearSearch('form')\" round>清空</el-button>\n      </el-form-item>\n    </el-form>\n    <router-link class=\"mt-10\" to=\"/tag/add\">\n      <el-button type=\"primary\" round>新增</el-button>\n    </router-link>\n  </div>\n\n  <el-table\n    ref=\"multipleTable\"\n    :data=\"tableData\"\n    tooltip-effect=\"dark\"\n    row-key=\"id\"\n    size=\"small\"\n    @selection-change=\"handleSelectionChange\"\n  >\n    <el-table-column type=\"selection\"></el-table-column>\n    <el-table-column prop=\"id\" label=\"编号\"></el-table-column>\n    <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\n    <el-table-column prop=\"path\" label=\"标识\"></el-table-column>\n\n    <el-table-column fixed=\"right\" label=\"操作\">\n      <template #default=\"scope\">\n        <el-button :icon=\"Edit\" circle @click=\"toEdit(scope.row)\"></el-button>\n        <el-button\n          :icon=\"Delete\"\n          circle\n          @click=\"handleDel(scope.row)\"\n        ></el-button>\n      </template>\n    </el-table-column>\n  </el-table>\n\n  <!-- 分页 -->\n  <el-row type=\"flex\" class=\"mt-20 align-c\" justify=\"center\">\n    <el-pagination\n      background\n      layout=\"prev, pager, next\"\n      @current-change=\"handleCurrentChange\"\n      :pager-size=\"10\"\n      :total=\"count\"\n      v-model:currentPage=\"cur\"\n      hide-on-single-page\n    ></el-pagination>\n  </el-row>\n</template>\n\n<script>\nimport { Delete, Edit, View, Search } from \"@element-plus/icons-vue\";\nimport { search, del } from \"@/api/tag.js\";\n\nexport default {\n  name: \"tag-index\",\n  setup() {\n    return {\n      Edit,\n      Delete,\n      View,\n      Search,\n    };\n  },\n  data: () => {\n    return {\n      tableData: [],\n      multipleSelection: [],\n      count: 0,\n      cur: 1,\n      params: {\n        keywords: \"\",\n      },\n    };\n  },\n  computed: {},\n  created() {\n    let { cur = 1, keywords = \"\" } = this.$route.query;\n\n    this.cur = +cur;\n    this.keywords = keywords;\n\n    this.search();\n  },\n  watch: {\n    $route(to, from) {\n      if (to.name == \"tag-index\") {\n        let { cur, keywords } = to.query;\n        this.cur = +cur;\n        this.keywords = keywords;\n        this.search();\n      }\n    },\n  },\n  methods: {\n    //清空搜索\n    clearSearch(str) {\n      if (str) {\n        this.$refs.form.resetFields();\n      }\n      this.$router.replace({\n        name: \"tag-index\",\n        query: { cur: 1, cid: 0, keywords: \"\" },\n      });\n      this.search();\n    },\n\n    doSearch() {\n      this.$router.replace({\n        name: \"tag-index\",\n        query: { cur: this.cur, keywords: this.params.keywords },\n      });\n\n      this.search();\n    },\n    //查询\n    async search() {\n      try {\n        let res = await search(this.cur, this.params.keywords);\n        if (res.code === 200) {\n          this.tableData = [...res.data.list];\n          this.count = res.data.count;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //翻页\n    handleCurrentChange(e) {\n      this.cur = +e;\n      this.doSearch();\n    },\n\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach((row) => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n\n    toEdit(e) {\n      let id = e.id;\n      this.$router.push({ name: \"tag-edit\", params: { id: id } });\n    },\n\n    //删除\n    async handleDel(e) {\n      let id = e.id;\n      try {\n        let res = await del(id);\n        if (res.code === 200) {\n          this.$message({\n            message: \"删除成功 ^_^\",\n            type: \"success\",\n          });\n          this.search();\n        } else {\n          this.$message({\n            message: res.msg,\n            type: \"error\",\n          });\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n  },\n};\n</script>\n<style scoped>\n:deep(.el-form-item) {\n  margin-bottom: 0px;\n}\n</style>\n"],"names":["_hoisted_1","class","name","setup","Delete","Search","data","multipleSelection","count","params","created","cur","keywords","this","$route","query","watch","to","from","methods","clearSearch","str","$router","replace","cid","res","code","tableData","list","console","log","error","doSearch","toggleSelection","rows","forEach","row","$refs","multipleTable","clearSelection","toEdit","e","async","del","id","$message","message","type","msg","_createElementVNode","inline","model","_ctx","ref","label","prop","placeholder","$setup","clearable","onClear","$options","modelValue","_cache","$event","onClick","search","round","size","onSelectionChange","handleSelectionChange","fixed","icon","Edit","circle","scope","handleDel","justify","background","layout","onCurrentChange","handleCurrentChange","total","currentPage"],"mappings":"uoBAEOA,EAAA,CAAAC,MAAA,8EAiEP,CACEC,KAAA,YACAC,MAAA,KACE,QAEEC,OAAAA,SAEAC,OAAAA,IAGJC,KAAA,KACE,cAEEC,kBAAA,GACAC,MAAA,QAEAC,OAAA,4BAMJC,UACE,IAAAC,IAAAA,EAAA,EAAAC,SAAAA,EAAA,IAAAC,KAAAC,OAAAC,iDAOFC,MAAA,CACEF,OAAAG,EAAAC,kGAME,IAGJC,QAAA,CAEEC,YAAAC,GACEA,iCAGAR,KAAAS,QAAAC,QAAA,CACErB,KAAA,YACAa,MAAA,CAAAJ,IAAA,EAAAa,IAAA,EAAAZ,SAAA,gCAMFC,KAAAS,QAAAC,QAAA,CACErB,KAAA,+FAQF,iDAEE,MAAAuB,EAAAC,OACEb,KAAAc,UAAA,IAAAF,EAAAnB,KAAAsB,wCAIFC,QAAAC,IAAAC,EACF,sCAMAlB,KAAAmB,YAGFC,gBAAAC,GACEA,EACEA,EAAAC,SAAAC,sDAIAvB,KAAAwB,MAAAC,cAAAC,qEAQJC,OAAAC,kEAMAC,gBAAAD,cAEE,IACE,IAAAhB,QAAAkB,EAAAC,GACA,MAAAnB,EAAAC,MACEb,KAAAgC,SAAA,CACEC,QAAA,WACAC,KAAA,2BAIFlC,KAAAgC,SAAA,CACEC,QAAArB,EAAAuB,4BAKJnB,QAAAC,IAAAC,EACF,oHAvLJkB,EAAA,MAAAjD,EAAA,MACYkD,QAAA,EAAeC,MAAAC,EAAA3C,OAAe4C,IAAA,8BACxBpD,MAAA,QAAcqD,MAAA,KAAWC,KAAA,kCAEnCtD,MAAA,eACAuD,YAAA,QACC,cAAAC,EAAApD,OACDqD,UAAA,GACCC,QAAAC,EAAAxC,YACQyC,WAAAT,EAAA3C,OAAAG,SAAA,sBAAAkD,EAAA,KAAAA,EAAA,GAAAC,GAAAX,EAAA3C,OAAAG,SAAAmD,sGAIAhB,KAAA,UAAgBiB,QAAAJ,EAAAK,OAAeC,MAAA,yDAC9BF,QAAAF,EAAA,KAAAA,EAAA,GAAAC,GAAAH,EAAAxC,YAAA,SAA4B8C,MAAA,yEAG/BjE,MAAA,QAAcgB,GAAA,kCACd8B,KAAA,UAAemB,MAAA,sDAK5Bb,IAAA,gBACC/C,KAAA8C,EAAAzB,UACD,iBAAA,OACA,UAAA,KACAwC,KAAA,QACCC,kBAAAR,EAAAS,qEAGgBd,KAAA,KAAUD,MAAA,YACVC,KAAA,OAAYD,MAAA,YACZC,KAAA,OAAYD,MAAA,YAEZgB,MAAA,QAAchB,MAAA,2BAEfiB,KAAAd,EAAAe,KAAYC,OAAA,GAAQT,QAAAD,GAAAH,EAAApB,OAAAkC,EAAAtC,sCAE7BmC,KAAAd,EAAArD,OACDqE,OAAA,GACCT,QAAAD,GAAAH,EAAAe,UAAAD,EAAAtC,uFAODW,KAAA,OAAY9C,MAAA,gBAAsB2E,QAAA,gCAEtCC,WAAA,GACAC,OAAA,oBACCC,gBAAAnB,EAAAoB,oBACA,aAAA,GACAC,MAAA7B,EAAA5C,MACO0E,YAAA9B,EAAAzC,mDACR,sBAAA"}