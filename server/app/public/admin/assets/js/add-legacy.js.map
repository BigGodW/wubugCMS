{"version":3,"file":"add-legacy.js","sources":["../../../src/views/ad/add.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"84px\"\n    >\n      <div>\n        <el-form-item label=\"广告名称\" prop=\"title\">\n          <el-input v-model=\"params.title\" placeholder=\"请输入汉字\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告链接\">\n          <el-input v-model=\"params.link\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告标识\" prop=\"mark\">\n          <el-input v-model=\"params.mark\" placeholder=\"模板使用标识\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告平台\">\n          <el-radio v-model=\"params.platform\" label=\"1\">PC</el-radio>\n          <el-radio v-model=\"params.platform\" label=\"2\">H5</el-radio>\n        </el-form-item>\n\n        <el-form-item label=\"广告位置\">\n          <el-checkbox-group v-model=\"params.position\" @change=\"handleAttr\">\n            <el-checkbox label=\"1\">首页</el-checkbox>\n            <el-checkbox label=\"2\">频道页</el-checkbox>\n            <el-checkbox label=\"3\">列表页</el-checkbox>\n            <el-checkbox label=\"4\">文章页</el-checkbox>\n            <el-checkbox label=\"5\">单页</el-checkbox>\n          </el-checkbox-group>\n        </el-form-item>\n\n        <el-form-item label=\"图片链接\">\n          <el-input v-model=\"params.imgUrl\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"广告图片\">\n          <el-upload\n            class=\"avatar-uploader\"\n            action=\"/api/upload\"\n            :on-success=\"upload\"\n            :show-file-list=\"false\"\n            :before-upload=\"beforeUpload\"\n          >\n            <el-image\n              style=\"width: 100%\"\n              v-if=\"params.imgUrl\"\n              :src=\"params.imgUrl\"\n            />\n            <el-icon v-else class=\"avatar-uploader-icon\"><Plus /></el-icon>\n          </el-upload>\n        </el-form-item>\n\n        <el-form-item label=\"发布时间\">\n          <el-date-picker\n            v-model=\"params.createdAt\"\n            type=\"datetime\"\n            placeholder=\"选择日期时间\"\n          ></el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"是否显示\">\n          <el-radio v-model=\"params.status\" label=\"1\">发布</el-radio>\n          <el-radio v-model=\"params.status\" label=\"2\">不发布</el-radio>\n        </el-form-item>\n      </div>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { create } from \"@/api/ad.js\";\nimport { pinyin } from \"pinyin-pro\";\nimport { Plus } from \"@element-plus/icons-vue\";\nexport default {\n  name: \"ad-add\",\n  data: () => {\n    return {\n      params: {\n        title: \"\",\n        mark: \"\",\n        imgUrl: \"\",\n        link: \"\",\n        platform: \"1\",\n        position: [\"1\"],\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        status: \"1\",\n      },\n      disabled: false,\n      paramsRules: {\n        //校验规则\n        title: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n        mark: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  components: {\n    Plus,\n  },\n\n  created() {},\n  watch: {\n    \"params.title\": function (newv, oldv) {\n      this.params.mark = pinyin(newv, { toneType: \"none\" }).replace(/\\s+/g, \"\");\n    },\n  },\n  methods: {\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    beforeUpload(rawFile) {\n      if (rawFile.size / 1024 / 1024 > 2) {\n        this.$message(\"上传文件必须小于1M\");\n        return false;\n      }\n    },\n\n    //上传缩略图\n    upload(res) {\n      if (res.code === 200) {\n        this.params.imgUrl = res.data.path;\n      }\n    },\n\n    //新增\n    async create() {\n      try {\n        let params = { ...this.params };\n        params.position = params.position\n          .sort((a, b) => {\n            return a - b;\n          })\n          .toString();\n        let res = await create(params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.create();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style scoped></style>\n"],"names":["_hoisted_1","class","data","params","title","mark","imgUrl","link","position","createdAt","Date","updatedAt","disabled","max","trigger","watch","newv","oldv","this","pinyin","toneType","replace","methods","console","log","e","beforeUpload","rawFile","res","code","path","a","b","$message","message","type","$router","go","error","submit","formName","$refs","validate","valid","_openBlock","_createElementBlock","ref","model","_ctx","rules","paramsRules","label","prop","modelValue","_cache","$event","placeholder","platform","onChange","$options","handleAttr","action","upload","style","width","status","onClick"],"mappings":"u1BAkFA,MAjFOA,EAAA,CAAAC,MAAA,mCAiFP,eAEEC,KAAAA,KACE,CACEC,OAAA,CACEC,MAAA,GACAC,KAAA,GACAC,OAAA,GACAC,KAAA,gBAEAC,SAAA,CAAA,KACAC,UAAA,IAAAC,KACAC,UAAA,IAAAD,iBAGFE,UAAA,eAGER,MAAA,gDAEE,OAEES,IAAA,gCAEAC,QAAA,8DAKF,OAEED,IAAA,gCAEAC,QAAA,4CAWVC,MAAA,CACE,eAAA,SAAAC,EAAAC,GACEC,KAAAf,OAAAE,KAAAc,EAAAH,EAAA,CAAAI,SAAA,SAAAC,QAAA,OAAA,MAGJC,QAAA,eAEIC,QAAAC,IAAA,UAAAC,IAGFC,aAAAC,0EASE,MAAAC,EAAAC,OACEX,KAAAf,OAAAG,OAAAsB,EAAA1B,KAAA4B,sBAMF,2BAEE3B,EAAAK,SAAAL,EAAAK,sBAEIuB,EAAAC,mCAKFd,KAAAe,SAAA,CACEC,QAAA,UACAC,KAAA,YAEFjB,KAAAkB,QAAAC,IAAA,aAGFd,QAAAC,IAAAc,EACF,GAGFC,OAAAC,GACEtB,KAAAuB,MAAAD,GAAAE,UAAAC,IACE,IAAAA,uDAKA,sGAlLN,OAAAC,IAAAC,EAAA,MAAA7C,EAAA,MAEI8C,IAAA,SACCC,MAAAC,EAAA7C,OACA8C,MAAAD,EAAAE,YACD,cAAA,4CAGgBC,MAAA,OAAaC,KAAA,+BACNC,WAAAL,EAAA7C,OAAAC,MAAA,sBAAAkD,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAC,MAAAmD,GAAcC,YAAA,kFAIdH,WAAAL,EAAA7C,OAAAI,KAAA,sBAAA+C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAI,KAAAgD,yCAGPJ,MAAA,OAAaC,KAAA,8BACNC,WAAAL,EAAA7C,OAAAE,KAAA,sBAAAiD,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAE,KAAAkD,GAAaC,YAAA,mFAIbH,WAAAL,EAAA7C,OAAAsD,SAAA,sBAAAH,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAsD,SAAAF,GAAiBJ,MAAA,6DACjBE,WAAAL,EAAA7C,OAAAsD,SAAA,sBAAAH,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAsD,SAAAF,GAAiBJ,MAAA,0GAIRE,WAAAL,EAAA7C,OAAAK,SAAA,sBAAA8C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAK,SAAA+C,GAAkBG,SAAAC,EAAAC,iXAU3BP,WAAAL,EAAA7C,OAAAG,OAAA,sBAAAgD,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAG,OAAAiD,6EAKjBtD,MAAA,kBACA4D,OAAA,cACC,aAAAF,EAAAG,OACA,kBAAA,EACA,gBAAAH,EAAAjC,+BAIOsB,EAAA7C,OAAAG,uBADNyD,MAAA,CAAAC,MAAA,8DAIc/D,MAAA,oJAMPoD,WAAAL,EAAA7C,OAAAM,UAAA,sBAAA6C,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAAM,UAAA8C,GACTpB,KAAA,WACAqB,YAAA,mFAKiBH,WAAAL,EAAA7C,OAAA8D,OAAA,sBAAAX,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAA8D,OAAAV,GAAeJ,MAAA,6DACfE,WAAAL,EAAA7C,OAAA8D,OAAA,sBAAAX,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAA7C,OAAA8D,OAAAV,GAAeJ,MAAA,mGAKzBhB,KAAA,UAAgB+B,QAAAZ,EAAA,MAAAA,EAAA,IAAAC,GAAAI,EAAApB,OAAA"}