{"version":3,"file":"edit10.js","sources":["../../../src/views/page/edit.vue"],"sourcesContent":["<template>\n  <div class=\"mr-10 ml-10\">\n    <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\n      <el-tab-pane label=\"基本信息\" name=\"first\"></el-tab-pane>\n      <el-tab-pane label=\"扩展信息\" name=\"second\"></el-tab-pane>\n    </el-tabs>\n  </div>\n\n  <div class=\"mr-10 ml-10 mb-20\">\n    <el-form\n      ref=\"params\"\n      :model=\"params\"\n      :rules=\"paramsRules\"\n      label-width=\"84px\"\n      class\n    >\n      <div v-show=\"activeIndex == 0\">\n        <el-form-item label=\"文章栏目\">\n          <el-cascader\n            :props=\"categoryProps\"\n            :show-all-levels=\"false\"\n            v-model=\"categorySelected\"\n            :options=\"category\"\n            @change=\"handleChange\"\n          ></el-cascader>\n        </el-form-item>\n\n        <el-form-item label=\"文章标题\" prop=\"title\">\n          <el-input v-model=\"params.title\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"文章内容\">\n          <vue3-tinymce\n            v-model=\"params.content\"\n            :setting=\"setting\"\n            script-src=\"/public/admin/tinymce/tinymce.min.js\"\n          />\n        </el-form-item>\n\n        <el-form-item label=\"内容功能\">\n          <el-checkbox v-model=\"autoImg\">\n            提取第\n            <el-input\n              v-model=\"picNum\"\n              class=\"w-80 mr-8 ml-8\"\n              placeholder=\"请输入内容\"\n            ></el-input\n            >张图片作封面\n          </el-checkbox>\n        </el-form-item>\n\n        <el-form-item label=\"提取文章描述\">\n          <el-checkbox v-model=\"autoDes\">提取文章描述</el-checkbox>\n        </el-form-item>\n\n        <el-form-item label=\"发布时间\">\n          <el-date-picker\n            v-model=\"params.createdAt\"\n            :default-value=\"new Date()\"\n            type=\"datetime\"\n            placeholder=\"选择日期时间\"\n          ></el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"是否显示\">\n          <el-radio v-model=\"params.status\" label=\"0\">发布</el-radio>\n          <el-radio v-model=\"params.status\" label=\"1\">不发布</el-radio>\n        </el-form-item>\n\n        <el-form-item label=\"浏览数\">\n          <el-input v-model=\"params.pv\"></el-input>\n        </el-form-item>\n      </div>\n\n      <div v-show=\"activeIndex == 1\">\n        <el-form-item label=\"SEO标题\">\n          <el-input v-model=\"params.seo_title\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"SEO关键词\">\n          <el-input v-model=\"params.seo_keywords\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"SEO描述\">\n          <el-input v-model=\"params.seo_description\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"来源\">\n          <el-input v-model=\"params.source\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"作者\">\n          <el-input v-model=\"params.author\"></el-input>\n        </el-form-item>\n      </div>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit('params')\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { find } from \"@/api/category.js\";\nimport { update, detail } from \"@/api/page.js\";\nimport { filterBody, addLabelValue, treeById, tree } from \"@/utils/tool.js\";\nimport Vue3Tinymce from \"@jsdawn/vue3-tinymce\";\nimport { tinymceSet } from \"@/config/tinymce.js\";\nexport default {\n  name: \"page-edit\",\n  components: {\n    Vue3Tinymce,\n  },\n  data: () => {\n    return {\n      setting: tinymceSet,\n      categorySelected: [], //-1默认选中顶级栏目\n      categoryProps: { checkStrictly: true },\n      activeName: \"first\", //tab 默认显示第一个\n      activeIndex: \"0\", //tab 内容默认显示第一个\n\n      category: [], //当前所有栏目\n      cateList: [], //所有栏目\n      autoImg: true,\n      autoDes: true,\n      picNum: 1,\n\n      params: {\n        //接口入参\n        id: 0,\n        cid: 0,\n        title: \"\",\n        seo_title: \"\",\n        seo_keywords: \"\",\n        seo_description: \"\",\n        source: \"\",\n        author: \"\",\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        content: \"禅悦\",\n        status: \"0\",\n        pv: 0,\n      },\n      dialogVisible: false,\n      disabled: false,\n      paramsRules: {\n        //校验规则\n        title: [\n          { required: true, message: \"请输入栏目名称\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 50,\n            message: \"名称长度在 2 到 50 个字符之间\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  computed: {},\n  unmounted() {},\n  mounted() {},\n  async created() {\n    this.params.id = this.$route.params.id;\n    await this.detail();\n    await this.query();\n  },\n  methods: {\n    handleClick(tab) {\n      this.activeIndex = tab.index;\n    },\n    setContent(article) {\n      this.params.content = article;\n    },\n    //查询栏目\n    async query() {\n      try {\n        let res = await find();\n        if (res.code === 200) {\n          let data = res.data;\n          let ids = treeById(this.params.cid, data);\n          this.categorySelected = ids;\n          let end = addLabelValue(tree(data));\n          this.cateList = addLabelValue(data);\n          this.category = [...end];\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //选择栏目\n    handleChange(e) {\n      if (e[0] != -1) {\n        this.params.cid = e[e.length - 1];\n      }\n    },\n\n    // 文章详情\n    async detail() {\n      try {\n        let res = await detail(this.params.id);\n        if (res.code === 200) {\n          this.params = res.data;\n          this.params.status = this.params.status.toString();\n          this.params.updatedAt = new Date(this.params.createdAt);\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    handleAttr(e) {\n      console.log(\"e-->\", e);\n    },\n\n    handleSubCid(e) {\n      console.log(\"e-->\", e);\n    },\n\n    //新增\n    async update() {\n      try {\n        let res = await update(this.params);\n        if (res.code) {\n          this.$message({\n            message: \"更新成功^_^\",\n            type: \"success\",\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    submit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.update();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n<style></style>\n"],"names":["_hoisted_1","class","_hoisted_2","name","data","setting","tinymceSet","categorySelected","categoryProps","checkStrictly","activeName","category","cateList","picNum","params","title","seo_keywords","seo_description","source","author","createdAt","Date","updatedAt","dialogVisible","disabled","max","trigger","async","this","id","$route","detail","query","methods","handleClick","tab","setContent","article","res","find","code","ids","treeById","cid","end","addLabelValue","tree","console","log","error","handleChange","e","handleSubCid","update","$message","message","type","$router","go","submit","formName","$refs","validate","valid","_createElementVNode","onTabClick","$options","label","ref","model","_ctx","rules","paramsRules","props","options","onChange","prop","modelValue","_cache","$event","content","placeholder","status","pv","seo_title","onClick"],"mappings":"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"}