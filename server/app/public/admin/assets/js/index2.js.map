{"version":3,"file":"index2.js","sources":["../../../src/views/admin/index.vue"],"sourcesContent":["<template>\n  <el-row type=\"flex\" class=\"mt-10 mb-10\" justify=\"end\">\n    <router-link to=\"/admin/add\">\n      <el-button type=\"primary\" round>新增</el-button>\n    </router-link>\n  </el-row>\n\n  <div class=\"mr-10 ml-10\">\n    <el-row>\n      <el-table\n        ref=\"multipleTable\"\n        :data=\"tableData\"\n        tooltip-effect=\"dark\"\n        row-key=\"id\"\n        size=\"small\"\n        @selection-change=\"handleSelectionChange\"\n      >\n        <el-table-column type=\"selection\"></el-table-column>\n        <el-table-column prop=\"id\" label=\"编号\"></el-table-column>\n        <el-table-column prop=\"username\" label=\"管理员\"></el-table-column>\n        <el-table-column prop=\"status\" label=\"状态\">\n          <template #default=\"scope\">{{\n            scope.row.status == 1 ? \"启用\" : \"关闭\"\n          }}</template>\n        </el-table-column>\n        <el-table-column prop=\"createdAt\" label=\"发布时间\">\n          <template #default=\"scope\">{{ scope.row.createdAt }}</template>\n        </el-table-column>\n        <el-table-column fixed=\"right\" width=\"100\" label=\"操作\">\n          <template #default=\"scope\">\n            <el-button\n              :icon=\"Edit\"\n              circle\n              @click=\"toEdit(scope.row)\"\n            ></el-button>\n            <el-button\n              :icon=\"Delete\"\n              :disabled=\"username == scope.row.username\"\n              circle\n              @click=\"handleDel(scope.row)\"\n            ></el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!-- 分页 -->\n      <el-row type=\"flex\" class=\"mt-20 align-c\" justify=\"center\">\n        <el-pagination\n          background\n          layout=\"prev, pager, next\"\n          @current-change=\"handleCurrentChange\"\n          :pager-size=\"10\"\n          :total=\"count\"\n          hide-on-single-page\n        ></el-pagination>\n      </el-row>\n      <!-- <div style=\"margin-top: 20px\">\n          批量操作：\n          <el-button @click=\"toggleSelection()\">删除</el-button>\n        </div> -->\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { Delete, Edit, View, Search } from \"@element-plus/icons-vue\";\nimport { list, del } from \"@/api/admin.js\";\nimport { getCookie, setCookie } from \"@/utils/tool\";\nexport default {\n  name: \"admin-index\",\n  setup() {\n    return {\n      Edit,\n      Delete,\n      View,\n      Search,\n    };\n  },\n  data: () => {\n    return {\n      keywords: \"\",\n      tableData: [],\n      multipleSelection: [],\n      count: 0,\n      cur: 1,\n      username: \"\",\n    };\n  },\n  computed: {},\n  created() {\n    this.username = getCookie(\"username\");\n    console.log(\"username-->\", this.username);\n    this.list();\n  },\n  methods: {\n    //查询\n    async list() {\n      try {\n        let res = await list(this.cur);\n        if (res.code === 200) {\n          this.tableData = [...res.data.list];\n          this.count = res.data.count;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //翻页\n    handleCurrentChange(e) {\n      this.cur = e;\n      this.list();\n    },\n\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach((row) => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n\n    //编辑\n    toEdit(e) {\n      let id = e.id;\n      this.$router.push({ name: \"admin-edit\", params: { id: id } });\n    },\n\n    //删除\n    async handleDel(e) {\n      let id = e.id;\n      try {\n        this.$confirm(\"这么疯狂，要删管理员？\", \"提示\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\",\n        })\n          .then(async () => {\n            let res = await del(id);\n            if (res.code === 200) {\n              this.$message({\n                message: \"删除成功 ^_^\",\n                type: \"success\",\n              });\n              this.list();\n            }\n          })\n          .catch(() => {\n            this.$message({\n              type: \"info\",\n              message: \"已取消删除\",\n            });\n          });\n      } catch (error) {\n        console.log(error);\n      }\n    },\n  },\n};\n</script>\n<style scoped></style>\n"],"names":["_hoisted_1","class","name","setup","Delete","Search","data","multipleSelection","count","created","this","username","getCookie","console","log","methods","res","code","tableData","list","error","toggleSelection","rows","forEach","row","$refs","multipleTable","clearSelection","toEdit","e","handleDel","$confirm","cancelButtonText","type","then","async","del","id","$message","message","justify","round","_createElementVNode","ref","_ctx","size","onSelectionChange","$options","handleSelectionChange","prop","label","fixed","width","icon","$setup","Edit","circle","onClick","$event","scope","disabled","background","layout","onCurrentChange","handleCurrentChange","total"],"mappings":"ioBAoEA,MA7DOA,EAAA,CAAAC,MAAA,yBA6DP,CACEC,KAAA,cACAC,MAAA,KACE,QAEEC,OAAAA,SAEAC,OAAAA,IAGJC,KAAA,KACE,0BAGEC,kBAAA,GACAC,MAAA,kCAMJ,OAAAC,GACEC,KAAAC,SAAAC,EAAA,YACAC,QAAAC,IAAA,iBAAAJ,KAAAC,uBAGFI,QAAA,cAGI,4BAEE,MAAAC,EAAAC,OACEP,KAAAQ,UAAA,IAAAF,EAAAV,KAAAa,wCAIFN,QAAAC,IAAAM,EACF,kDASF,eAAAC,CAAAC,GACEA,EACEA,EAAAC,SAAAC,sDAIAd,KAAAe,MAAAC,cAAAC,qEASJ,MAAAC,CAAAC,oEAMA,eAAAC,CAAAD,cAEE,IACEnB,KAAAqB,SAAA,cAAA,KAAA,wBAEEC,iBAAA,KACAC,KAAA,YAEAC,MAAAC,UAEE,aADAC,EAAAC,IACApB,OACEP,KAAA4B,SAAA,CACEC,QAAA,WACAN,KAAA,wBAGJ,gBAGAvB,KAAA4B,SAAA,aAEEC,QAAA,SACF,aAGJ1B,QAAAC,IAAAM,EACF,6GAhKIa,KAAA,OAAYhC,MAAA,cAAoBuC,QAAA,oEAEzBP,KAAA,UAAeQ,MAAA,wDAI9BC,EAAA,MAAA1C,EAAA,gCAGM2C,IAAA,gBACCrC,KAAAsC,EAAA1B,UACD,iBAAA,OACA,UAAA,KACA2B,KAAA,QACCC,kBAAAC,EAAAC,qEAGgBC,KAAA,KAAUC,MAAA,YACVD,KAAA,WAAgBC,MAAA,aAChBD,KAAA,SAAcC,MAAA,sEAKdD,KAAA,YAAiBC,MAAA,8DAGjBC,MAAA,QAAcC,MAAA,MAAYF,MAAA,2BAGpCG,KAAAC,EAAAC,KACDC,OAAA,GACCC,QAAAC,GAAAX,EAAAnB,OAAA+B,EAAAnC,sCAGA6B,KAAAC,EAAAlD,OACAwD,SAAAhB,EAAAjC,UAAAgD,EAAAnC,IAAAb,SACD6C,OAAA,GACCC,QAAAC,GAAAX,EAAAjB,UAAA6B,EAAAnC,kGAODS,KAAA,OAAYhC,MAAA,gBAAsBuC,QAAA,gCAEtCqB,WAAA,GACAC,OAAA,oBACCC,gBAAAhB,EAAAiB,oBACA,aAAA,GACAC,MAAArB,EAAApC,MACD,sBAAA"}