import{Y as S,P as v,v as x,M as D}from"./@element-plus.js";import{s as V,d as m}from"./page.js";import{_ as B}from"./index.js";import{ag as i,aq as E,o as _,c as T,Z as t,V as l,W as j,U as N,F as $,Y as s,t as f,a as z}from"./@vue.js";import"./api.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";const A={name:"page-index",setup(){return{Edit:S,Delete:v,View:x,Search:D}},data:()=>({keywords:"",tableData:[],multipleSelection:[],count:0,cur:1,loading:!0}),computed:{},created(){this.search()},methods:{clearSearch(){this.keywords="",this.tableData=[],this.multipleSelection=[],this.count=0,this.cur=1,this.search()},async search(){try{let e=await V(this.cur,this.keywords);e.code===200&&(this.tableData=[...e.data.list],this.count=e.data.count,this.loading=!1)}catch(e){console.log(e)}},handleCurrentChange(e){this.cur=e,this.search()},toggleSelection(e){e?e.forEach(a=>{this.$refs.multipleTable.toggleRowSelection(a)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},toEdit(e){let a=e.id;this.$router.push({name:"page-edit",params:{id:a}})},delSome(){let e=this.multipleSelection.map(a=>a.id);this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{(await m(e.join(","))).code===200&&(this.$message({message:"\u6587\u7AE0\u5220\u9664\u6210\u529F ^_^",type:"success"}),this.search())}).catch(()=>{this.$message({type:"info",message:"\u5DF2\u53D6\u6D88\u5220\u9664"})})},async handleDel(e){let a=e.id;try{(await m(a)).code===200&&(this.$message({message:"\u6587\u7AE0\u5220\u9664\u6210\u529F ^_^",type:"success"}),this.search())}catch(p){console.log(p)}}}},F={style:{"margin-top":"20px"}};function U(e,a,p,d,Y,n){const g=i("el-input"),c=i("el-button"),w=i("el-col"),y=i("router-link"),u=i("el-row"),r=i("el-table-column"),C=i("el-table"),k=i("el-pagination"),b=E("loading");return _(),T($,null,[t(u,{type:"flex",justify:"space-between"},{default:l(()=>[t(w,{span:18},{default:l(()=>[t(g,{class:"mr-10 w-auto",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9","suffix-icon":d.Search,modelValue:e.keywords,"onUpdate:modelValue":a[0]||(a[0]=o=>e.keywords=o)},null,8,["suffix-icon","modelValue"]),t(c,{type:"primary",onClick:n.search,round:""},{default:l(()=>[s("\u641C\u7D22")]),_:1},8,["onClick"]),t(c,{onClick:n.clearSearch,round:""},{default:l(()=>[s("\u6E05\u7A7A")]),_:1},8,["onClick"])]),_:1}),t(y,{class:"c-fff add-btn",to:"/page/add"},{default:l(()=>[s("\u65B0\u589E")]),_:1})]),_:1}),j((_(),N(C,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark","row-key":"id",size:"small",onSelectionChange:n.handleSelectionChange},{default:l(()=>[t(r,{type:"selection"}),t(r,{prop:"id",label:"\u7F16\u53F7",width:"60"}),t(r,{prop:"title",label:"\u6807\u9898"}),t(r,{prop:"name",label:"\u6240\u5C5E\u680F\u76EE",width:"80"}),t(r,{prop:"createdAt",label:"\u53D1\u5E03\u65F6\u95F4",width:"160"},{default:l(o=>[s(f(o.row.createdAt),1)]),_:1}),t(r,{prop:"status",label:"\u72B6\u6001",width:"60"},{default:l(o=>[s(f(o.row.status==0?"\u663E\u793A":"\u9690\u85CF"),1)]),_:1}),t(r,{fixed:"right",label:"\u64CD\u4F5C",width:"150"},{default:l(o=>[t(c,{icon:d.View,circle:"",onClick:h=>e.handleClick(o.row)},null,8,["icon","onClick"]),t(c,{icon:d.Edit,circle:"",onClick:h=>n.toEdit(o.row)},null,8,["icon","onClick"]),t(c,{icon:d.Delete,circle:"",onClick:h=>n.handleDel(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[b,e.loading]]),t(u,{type:"flex",class:"mt-20",justify:"space-between"},{default:l(()=>[z("div",F,[s(" \u6279\u91CF\u64CD\u4F5C\uFF1A "),t(c,{onClick:n.delSome},{default:l(()=>[s("\u5220\u9664")]),_:1},8,["onClick"])]),t(k,{background:"",layout:"prev, pager, next",onCurrentChange:n.handleCurrentChange,"pager-size":10,total:e.count,"hide-on-single-page":""},null,8,["onCurrentChange","total"])]),_:1})],64)}const ie=B(A,[["render",U],["__scopeId","data-v-81390d46"]]);export{ie as default};
