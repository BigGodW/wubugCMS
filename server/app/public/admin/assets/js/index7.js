import{Y as S,P as v,v as x,M as D}from"./@element-plus.js";import{s as V,d as h}from"./page.js";import{_ as B}from"./index.js";import{ag as i,aq as E,o as _,c as T,Z as t,V as l,W as j,U as N,F as $,Y as s,t as f,a as z}from"./@vue.js";import"./api.js";import"./axios.js";import"./form-data.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";const A={name:"page-index",setup(){return{Edit:S,Delete:v,View:x,Search:D}},data:()=>({keywords:"",tableData:[],multipleSelection:[],count:0,cur:1,loading:!0}),computed:{},created(){this.search()},methods:{clearSearch(){this.keywords="",this.tableData=[],this.multipleSelection=[],this.count=0,this.cur=1,this.search()},async search(){try{let e=await V(this.cur,this.keywords);e.code===200&&(this.tableData=[...e.data.list],this.count=e.data.count,this.loading=!1)}catch(e){console.log(e)}},handleCurrentChange(e){this.cur=e,this.search()},toggleSelection(e){e?e.forEach(a=>{this.$refs.multipleTable.toggleRowSelection(a)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},toEdit(e){let a=e.id;this.$router.push({name:"page-edit",params:{id:a}})},delSome(){let e=this.multipleSelection.map(a=>a.id);this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await h(e.join(","))).code===200&&(this.$message({message:"文章删除成功 ^_^",type:"success"}),this.search())}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},async handleDel(e){let a=e.id;try{(await h(a)).code===200&&(this.$message({message:"文章删除成功 ^_^",type:"success"}),this.search())}catch(p){console.log(p)}}}},F={style:{"margin-top":"20px"}};function U(e,a,p,d,Y,n){const g=i("el-input"),c=i("el-button"),w=i("el-col"),y=i("router-link"),u=i("el-row"),r=i("el-table-column"),C=i("el-table"),k=i("el-pagination"),b=E("loading");return _(),T($,null,[t(u,{type:"flex",justify:"space-between"},{default:l(()=>[t(w,{span:18},{default:l(()=>[t(g,{class:"mr-10 w-auto",placeholder:"请输入内容","suffix-icon":d.Search,modelValue:e.keywords,"onUpdate:modelValue":a[0]||(a[0]=o=>e.keywords=o)},null,8,["suffix-icon","modelValue"]),t(c,{type:"primary",onClick:n.search,round:""},{default:l(()=>[s("搜索")]),_:1},8,["onClick"]),t(c,{onClick:n.clearSearch,round:""},{default:l(()=>[s("清空")]),_:1},8,["onClick"])]),_:1}),t(y,{class:"c-fff add-btn",to:"/page/add"},{default:l(()=>[s("新增")]),_:1})]),_:1}),j((_(),N(C,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark","row-key":"id",size:"small",onSelectionChange:n.handleSelectionChange},{default:l(()=>[t(r,{type:"selection"}),t(r,{prop:"id",label:"编号",width:"60"}),t(r,{prop:"title",label:"标题"}),t(r,{prop:"name",label:"所属栏目",width:"80"}),t(r,{prop:"createdAt",label:"发布时间",width:"160"},{default:l(o=>[s(f(o.row.createdAt),1)]),_:1}),t(r,{prop:"status",label:"状态",width:"60"},{default:l(o=>[s(f(o.row.status==0?"显示":"隐藏"),1)]),_:1}),t(r,{fixed:"right",label:"操作",width:"150"},{default:l(o=>[t(c,{icon:d.View,circle:"",onClick:m=>e.handleClick(o.row)},null,8,["icon","onClick"]),t(c,{icon:d.Edit,circle:"",onClick:m=>n.toEdit(o.row)},null,8,["icon","onClick"]),t(c,{icon:d.Delete,circle:"",onClick:m=>n.handleDel(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[b,e.loading]]),t(u,{type:"flex",class:"mt-20",justify:"space-between"},{default:l(()=>[z("div",F,[s(" 批量操作： "),t(c,{onClick:n.delSome},{default:l(()=>[s("删除")]),_:1},8,["onClick"])]),t(k,{background:"",layout:"prev, pager, next",onCurrentChange:n.handleCurrentChange,"pager-size":10,total:e.count,"hide-on-single-page":""},null,8,["onCurrentChange","total"])]),_:1})],64)}const ne=B(A,[["render",U],["__scopeId","data-v-81390d46"]]);export{ne as default};
