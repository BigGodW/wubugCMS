import{A as e,B as a,C as l,r as t,q as s,v as o,M as r,f as d,p as m}from"./element-plus.js";import{f as i,c as p}from"./category.js";import{_ as u,b as n,t as c}from"./index.js";import{l as h}from"./model.js";import{p as g}from"./pinyin-pro.js";import{o as y,c as V,a as f,U as _,W as b,a1 as j,_ as v,F as U,aa as P,X as C,t as S,a2 as k}from"./@vue.js";import"./lodash-es.js";import"./async-validator.js";import"./@vueuse.js";import"./dayjs.js";import"./@element-plus.js";import"./@ctrl.js";import"./@popperjs.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vue-router.js";import"./axios.js";import"./js-cookie.js";/* empty css        */const x={class:"mr-10 ml-10"},w={class:"mr-10 ml-10 mb-20"};const q=u({name:"category-add",data:()=>({categorySelected:[],categorySelectedPath:"",categoryProps:{checkStrictly:!0},activeName:"first",activeIndex:"0",category:[],modList:[],params:{pid:0,seo_title:"",seo_keywords:"",seo_description:"",name:"",path:"",pinyin:"",mid:"0",description:"",url:"",sort:0,type:"0",target:"0",status:"0"},paramsRules:{name:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:10,message:"名称长度在 2 到 10 个字符之间",trigger:"blur"}]}}),created(){this.query(),this.modelList()},methods:{createPinyin(e){this.params.pinyin=g(e,{toneType:"none"}).replace(/\s+/g,""),this.params.path=this.categorySelectedPath?this.categorySelectedPath+this.params.pinyin:"/"+this.categorySelectedPath+this.params.pinyin},changePath(e){this.params.path=this.categorySelectedPath?this.categorySelectedPath+e:"/"+this.categorySelectedPath+e},handleClick(e){this.activeIndex=e.index},async query(){try{let e=await i();if(200===e.code){let a=n(c(e.data));this.cate=e.data,this.category=[...a]}}catch(e){console.log(e)}},handleChange(e){let a=[];Object.values(e).forEach((e=>{this.cate.forEach((l=>{l.id==e&&a.push("/"+l.pinyin)}))})),this.categorySelectedPath=a.join("")+"/",this.params.path=this.categorySelectedPath+this.params.pinyin,-1!=e[0]&&(this.params.pid=e[e.length-1])},async modelList(){try{let e=await h(this.cur);200===e.code&&(this.modList=e.data.list)}catch(e){console.log(e)}},async categoryAdd(){try{(await p(this.params)).code&&(this.$message({message:"更新成功^_^",type:"success"}),this.$router.go(-1))}catch(e){console.log(e)}},submit(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;this.categoryAdd()}))}}},[["render",function(i,p,u,n,c,h){const g=e,q=a,L=l,I=t,A=s,E=o,N=r,T=d,$=m;return y(),V(U,null,[f("div",x,[_(q,{modelValue:i.activeName,"onUpdate:modelValue":p[0]||(p[0]=e=>i.activeName=e),onTabClick:h.handleClick},{default:b((()=>[_(g,{label:"基本信息",name:"first"}),_(g,{label:"SEO设置",name:"second"})])),_:1},8,["modelValue","onTabClick"])]),f("div",w,[_($,{ref:"params",model:i.params,"label-width":"84px"},{default:b((()=>[j(f("div",null,[_(I,{label:"上级栏目"},{default:b((()=>[_(L,{props:i.categoryProps,"show-all-levels":!1,modelValue:i.categorySelected,"onUpdate:modelValue":p[1]||(p[1]=e=>i.categorySelected=e),options:i.category,onChange:h.handleChange,placeholder:"不选择为顶级栏目"},null,8,["props","modelValue","options","onChange"])])),_:1}),_(I,{label:"栏目名称",prop:"name",rules:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:1,max:10,message:"栏目不能超过10个字",trigger:"blur"}]},{default:b((()=>[_(A,{modelValue:i.params.name,"onUpdate:modelValue":p[2]||(p[2]=e=>i.params.name=e),onChange:h.createPinyin},null,8,["modelValue","onChange"])])),_:1}),_(I,{label:"栏目标识"},{default:b((()=>[_(A,{modelValue:i.params.pinyin,"onUpdate:modelValue":p[3]||(p[3]=e=>i.params.pinyin=e),onChange:h.changePath},null,8,["modelValue","onChange"])])),_:1}),_(I,{label:"栏目路径"},{default:b((()=>[_(A,{modelValue:i.params.path,"onUpdate:modelValue":p[4]||(p[4]=e=>i.params.path=e),disabled:""},null,8,["modelValue"])])),_:1}),_(I,{label:"栏目类型"},{default:b((()=>[_(E,{modelValue:i.params.type,"onUpdate:modelValue":p[5]||(p[5]=e=>i.params.type=e),label:"0"},{default:b((()=>[v("栏目")])),_:1},8,["modelValue"]),_(E,{modelValue:i.params.type,"onUpdate:modelValue":p[6]||(p[6]=e=>i.params.type=e),label:"1"},{default:b((()=>[v("单页")])),_:1},8,["modelValue"])])),_:1}),_(I,{label:"扩展模型"},{default:b((()=>[_(N,{modelValue:i.params.mid,"onUpdate:modelValue":p[7]||(p[7]=e=>i.params.mid=e)},{default:b((()=>[_(E,{label:"0"},{default:b((()=>[v("基本模型")])),_:1}),(y(!0),V(U,null,P(i.modList,((e,a)=>(y(),C(E,{key:a,label:e.id},{default:b((()=>[v(S(e.model_name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(I,{label:"是否显示"},{default:b((()=>[_(E,{modelValue:i.params.status,"onUpdate:modelValue":p[8]||(p[8]=e=>i.params.status=e),label:"0"},{default:b((()=>[v("显示")])),_:1},8,["modelValue"]),_(E,{modelValue:i.params.status,"onUpdate:modelValue":p[9]||(p[9]=e=>i.params.status=e),label:"1"},{default:b((()=>[v("隐藏")])),_:1},8,["modelValue"])])),_:1}),_(I,{label:"栏目排序"},{default:b((()=>[_(A,{modelValue:i.params.sort,"onUpdate:modelValue":p[10]||(p[10]=e=>i.params.sort=e)},null,8,["modelValue"])])),_:1})],512),[[k,0==i.activeIndex]]),j(f("div",null,[_(I,{label:"栏目描述"},{default:b((()=>[_(A,{modelValue:i.params.description,"onUpdate:modelValue":p[11]||(p[11]=e=>i.params.description=e)},null,8,["modelValue"])])),_:1}),_(I,{label:"栏目链接"},{default:b((()=>[_(A,{modelValue:i.params.url,"onUpdate:modelValue":p[12]||(p[12]=e=>i.params.url=e)},null,8,["modelValue"])])),_:1}),_(I,{label:"打开方式"},{default:b((()=>[_(E,{modelValue:i.params.target,"onUpdate:modelValue":p[13]||(p[13]=e=>i.params.target=e),label:"0"},{default:b((()=>[v("当前页面")])),_:1},8,["modelValue"]),_(E,{modelValue:i.params.target,"onUpdate:modelValue":p[14]||(p[14]=e=>i.params.target=e),label:"1"},{default:b((()=>[v("新页面")])),_:1},8,["modelValue"])])),_:1}),_(I,{label:"seo标题"},{default:b((()=>[_(A,{modelValue:i.params.seo_title,"onUpdate:modelValue":p[15]||(p[15]=e=>i.params.seo_title=e)},null,8,["modelValue"])])),_:1}),_(I,{label:"seo关键词"},{default:b((()=>[_(A,{modelValue:i.params.seo_keywords,"onUpdate:modelValue":p[16]||(p[16]=e=>i.params.seo_keywords=e)},null,8,["modelValue"])])),_:1}),_(I,{label:"seo描述"},{default:b((()=>[_(A,{modelValue:i.params.seo_description,"onUpdate:modelValue":p[17]||(p[17]=e=>i.params.seo_description=e)},null,8,["modelValue"])])),_:1})],512),[[k,1==i.activeIndex]]),_(I,null,{default:b((()=>[_(T,{type:"primary",onClick:p[18]||(p[18]=e=>h.submit("params"))},{default:b((()=>[v("保存")])),_:1})])),_:1})])),_:1},8,["model"])])],64)}]]);export{q as default};
