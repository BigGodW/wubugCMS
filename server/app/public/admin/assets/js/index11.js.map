{"version":3,"file":"index11.js","sources":["../../../src/views/login/index.vue","../../../src/api/index.js"],"sourcesContent":["<template>\n  <div class=\"page\">\n    <div class=\"login\">\n      <h1 class=\"title\">禅悦cms后台管理系统</h1>\n      <div class=\"login-cont\">\n        <el-form\n          class=\"mt-20\"\n          ref=\"loginForm\"\n          :model=\"loginForm\"\n          :rules=\"loginRules\"\n          label-width=\"70px\"\n        >\n          <el-form-item label=\"用户名\" prop=\"username\">\n            <el-input v-model=\"loginForm.username\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"密码\" prop=\"password\">\n            <el-input type=\"password\" v-model=\"loginForm.password\"></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"验证码\" prop=\"captcha\">\n            <el-row :gutter=\"20\">\n              <el-col :span=\"15\"\n                ><el-input\n                  v-model=\"loginForm.captcha\"\n                  placeholder=\"请输入验证码\"\n                ></el-input\n              ></el-col>\n              <el-col :span=\"4\"\n                ><span\n                  class=\"captcha block pointer\"\n                  v-html=\"captcha\"\n                  @click=\"getCaptcha\"\n                ></span\n              ></el-col>\n            </el-row>\n          </el-form-item>\n\n          <el-form-item>\n            <el-button size=\"large\" type=\"primary\" @click=\"login\"\n              >登录</el-button\n            >\n          </el-form-item>\n        </el-form>\n      </div>\n    </div>\n\n    <footer class=\"login-footer overflow-h\">\n      <p class=\"f-13 text-c mt-10 c-fff\">\n        &copy;\n        <a\n          href=\"http://www.chanyue.top\"\n          class=\"mr-5 c-fff\"\n          target=\"_blank\"\n          title=\"chanyue\"\n          >www.chanyue.top</a\n        >\n        禅悦系统 ● 位于南京 服务全国\n      </p>\n    </footer>\n  </div>\n</template>\n\n<script>\nimport { defineComponent } from \"vue\";\nimport { userStore } from \"@/stores/user\";\nimport { login, captcha } from \"@/api/index\";\nimport { setCookie, getCookie } from \"@/utils/tool.js\";\n\nexport default defineComponent({\n  data() {\n    return {\n      loginForm: {\n        username: \"\",\n        password: \"\",\n        captcha: \"\", // 添加验证码属性\n      },\n      loginRules: {\n        username: [\n          { required: true, message: \"请输入用户名\", trigger: \"blur\" },\n        ],\n        password: [{ required: true, message: \"请输入密码\", trigger: \"blur\" }],\n        captcha: [{ required: true, message: \"请输入验证码\", trigger: \"blur\" }],\n      },\n      captcha: \"\", // 添加验证码图片链接属性\n    };\n  },\n  created() {\n    this.getCaptcha();\n  },\n  methods: {\n    async getCaptcha() {\n      try {\n        let v = Math.random().toString().slice(4, 8);\n        let res = await captcha(v);\n        this.captcha = res;\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    async login() {\n      const users = userStore();\n      this.$refs.loginForm.validate((valid) => {\n        if (valid) {\n          // 验证码验证逻辑\n          console.log();\n          if (\n            this.loginForm.captcha.toLowerCase() !==\n            getCookie(\"captcha\").toLowerCase()\n          ) {\n            // eslint-disable-next-line no-undef\n            ElMessage({\n              message: \"验证码错误\",\n              type: \"warning\",\n            });\n            return false;\n          }\n          // 登录逻辑 当需要返回用await 不需要返回值，可以用then\n          const { username, password } = this.loginForm;\n          users.login({ username, password }).then((res) => {\n            if (res.code == 500) {\n              // eslint-disable-next-line no-undef\n              ElNotification({\n                title: \"提示\",\n                message: \"登录失败\",\n                type: \"error\",\n              });\n              return false;\n            }\n            // eslint-disable-next-line no-undef\n            ElNotification({\n              title: \"提示\",\n              message: \"登录成功\",\n              duration: 800,\n              type: \"success\",\n            });\n            this.$router.push({\n              path: this.$route.query.redirect || \"/\",\n            });\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n  },\n});\n</script>\n<style lang=\"less\" scoped>\n.page {\n  background-image: linear-gradient(300deg, #778cca, #65de83);\n  min-height: 100vh;\n}\n.login {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  height: calc(100vh - 50px);\n  .title {\n    font-size: 36px;\n    margin-bottom: 20px;\n    color: #fff;\n    text-align: center;\n    font-weight: lighter;\n  }\n  .login-cont {\n    max-width: 500px;\n    background-color: #fff;\n    border-radius: 6px;\n    padding: 20px;\n    margin: 20px;\n  }\n}\n.login-phone {\n  display: flex;\n}\n\n.captcha {\n  height: 32px;\n  width: 100px;\n  svg {\n    width: 100%;\n  }\n}\n\n// .login-wrap {\n//   min-height: 540px;\n// }\n\n.login-footer {\n  height: 50px;\n}\n\n.pointer {\n  cursor: pointer;\n}\n.mt-20 {\n  margin-top: 20px;\n}\n</style>\n","import http from \"../utils/http.js\";\nimport API from \"../config/index.js\";\n\n/**\n * @description 登录\n * @param {*} param\n */\nexport let login = ({ username, password }) => {\n  return http({\n    url: `${API.BASE_API}/api/admin/login`,\n    method: \"post\",\n    data: {\n      username,\n      password,\n    },\n  });\n};\n\n/**\n * @description 注册\n * @param {*} param\n */\nexport let create = ({ username, password }) => {\n  return http({\n    url: `${API.BASE_API}/api/auth/admin/create`,\n    method: \"post\",\n    data: {\n      username,\n      password,\n    },\n  });\n};\n\n//验证码\nexport let captcha = (ver) => {\n  return http({\n    url: `${API.BASE_API}/api/captcha?v=${ver}`,\n    method: \"get\",\n  });\n};\n"],"names":["_sfc_main","defineComponent","data","captcha","username","created","this","getCaptcha","methods","async","v","Math","random","toString","slice","ver","http","url","API","BASE_API","method","res","console","log","error","$refs","loginForm","validate","valid","toLowerCase","getCookie","message","type","password","users","login","then","code","ElNotification","$router","push","path","$route","query","redirect","_hoisted_1","class","_hoisted_2","_hoisted_3","_withScopeId","createBaseVNode","_hoisted_4","href","target","title","_openBlock","_createElementBlock","_createElementVNode","ref","model","_ctx","rules","loginRules","label","prop","modelValue","_cache","$event","placeholder","innerHTML","onClick","args","size"],"mappings":"gnBAoEAA,EAAAC,EAAA,CACEC,KAAA,KACE,oCAIIC,QAAA,gBAGAC,SAAA,8KASNC,UACEC,KAAAC,cAEFC,QAAA,CACEC,mBACE,IACE,IAAAC,EAAAC,KAAAC,SAAAC,WAAAC,MAAA,EAAA,WC1DcC,IACbC,EAAK,CACVC,IAAK,GAAGC,EAAIC,0BAA0BJ,IACtCK,OAAQ,SDyDJd,KAAAH,QAAAkB,WAEAC,QAAAC,IAAAC,EACF,CC/De,IAACT,6BDoEhBT,KAAAmB,MAAAC,UAAAC,UAAAC,IACE,IAAAA,WAAA,CAII,iBAAAtB,KAAAoB,UAAAvB,QAAA0B,gBACAC,EAAA,WAAAD,wBAIEE,QAAA,QACAC,KAAA,eAKJ,MAAA5B,SAAAA,EAAA6B,SAAAA,GAAA3B,KAAAoB,UACAQ,EAAAC,MAAA,CAAA/B,WAAA6B,aAAAG,MAAAf,IACE,GAAA,KAAAA,EAAAgB,YAEEC,EAAA,YAEEP,QAAA,yBAMJO,EAAA,YAEEP,QAAA,oBAEAC,KAAA,YAEF1B,KAAAiC,QAAAC,KAAA,CACEC,KAAAnC,KAAAoC,OAAAC,MAAAC,UAAA,KACF,IAIJ,gDA7IDC,EAAA,CAAAC,MAAA,QACEC,EAAA,CAAAD,MAAA,SACHE,EAAAC,GAAA,IAAAC,EAAA,KAAA,CAAAJ,MAAA,SAAA,eAAA,KACKK,EAAA,CAAAL,MAAA,8IA8CDM,KAAA,yBACAN,MAAA,aACAO,OAAA,SACAC,MAAA,0IApDR,OAAAC,IAAAC,EAAA,MAAAX,EAAA,CACEY,EAAA,MAAAV,EAAA,GAEEU,EAAA,MAAAN,EAAA,MAEIL,MAAA,QACAY,IAAA,YACCC,MAAAC,EAAAlC,UACAmC,MAAAD,EAAAE,WACD,cAAA,8BAEcC,MAAA,MAAYC,KAAA,kCACLC,WAAAL,EAAAlC,UAAAtB,SAAA,sBAAA8D,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAAlC,UAAAtB,SAAA+D,yCAEPJ,MAAA,KAAWC,KAAA,kCACbhC,KAAA,WAAyBiC,WAAAL,EAAAlC,UAAAO,SAAA,sBAAAiC,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAAlC,UAAAO,SAAAkC,yCAGvBJ,MAAA,MAAYC,KAAA,iGAITC,WAAAL,EAAAlC,UAAAvB,QAAA,sBAAA+D,EAAA,KAAAA,EAAA,GAAAC,GAAAP,EAAAlC,UAAAvB,QAAAgE,GACTC,YAAA,kFAKAtB,MAAA,wBACAuB,UAAAT,EAAAzD,QACCmE,QAAAJ,EAAA,KAAAA,EAAA,GAAA,IAAAK,IAAAX,EAAArD,YAAAqD,EAAArD,cAAAgE,yEAOIC,KAAA,QAAaxC,KAAA,UAAgBsC,QAAAV,EAAAzB"}